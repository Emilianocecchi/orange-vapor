<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creativos Orange Vapor - Campañas de Tráfico v4 (Homepage Context)</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            font-size: 28px;
            color: #2c2c2c;
            margin-bottom: 10px;
        }
        .header p {
            color: #666;
            font-size: 16px;
        }
        .tabs {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        .tab-group {
            display: inline-flex;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
        }
        .tab-button {
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 500;
            background-color: white;
            color: #333;
            border: 1px solid #ddd;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .tab-button:first-child {
            border-top-left-radius: 6px;
            border-bottom-left-radius: 6px;
        }
        .tab-button:last-child {
            border-top-right-radius: 6px;
            border-bottom-right-radius: 6px;
        }
        .tab-button.active {
            color: white;
        }
        .tab-button.optimizacion.active { background-color: #dc3545; border-color: #dc3545; }
        .tab-button.meta.active { background-color: #1877F2; border-color: #1877F2; }
        .tab-button.google.active { background-color: #4285F4; border-color: #4285F4; }
        .tab-button.email.active { background-color: #00829b; border-color: #00829b; }
        .tab-button.chatbot.active { background-color: #6f42c1; border-color: #6f42c1; }
        .tab-button.all.active { background-color: #333333; border-color: #333333; }
        .tab-button.auditoria.active { background-color: #28a745; border-color: #28a745; }

        /* Selector de color */
        .color-toggle { text-align: center; margin: 20px 0; }
        .color-btn { width: 36px; height: 36px; border-radius: 50%; margin: 0 5px; cursor: pointer; display: inline-block; border: 2px solid #ddd; transition: all 0.2s ease; overflow: hidden; }
        .color-btn.active { border-color: #ff7e00; transform: scale(1.1); }
        .color-btn-original { background: linear-gradient(135deg, #dc3545 25%, #1877F2 25%, #1877F2 50%, #4285F4 50%, #4285F4 75%, #6f42c1 75%); }
        .color-btn-orange { background-color: #ff7e00; }
        .color-btn-white { background-color: #ffffff; border: 2px solid #ccc; }
        .color-btn-black { background-color: #181818; }

        .download-section { text-align: center; margin: 20px 0; }
        .download-btn { background: #ff7e00; color: white; border: none; padding: 12px 24px; font-size: 16px; font-weight: bold; border-radius: 6px; cursor: pointer; display: inline-flex; align-items: center; gap: 10px; box-shadow: 0 4px 8px rgba(255, 126, 0, 0.3); transition: all 0.3s ease; }
        .download-btn:hover { background: #e67300; transform: translateY(-2px); }

        .creatives-container { display: flex; flex-wrap: wrap; justify-content: center; margin-top: 20px; }
        .creative {
            width: 360px;
            height: 360px;
            margin: 10px;
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            color: white;
            cursor: pointer;
        }
        .creative-vertical { width: 216px; height: 384px; }
        .creative-content {
            position: relative;
            z-index: 2;
            padding: 20px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        .creative-vertical .creative-content {
             justify-content: flex-start;
             padding-top: 18%;
             padding-bottom: 15%;
        }
        .creative-title {
            font-weight: 800;
            margin-bottom: 15px;
            line-height: 1.15;
            font-size: 22px;
        }
        .creative-vertical .creative-title { font-size: 28px; }

        .creative-subtitle {
            font-weight: bold;
            margin-bottom: 15px;
            line-height: 1.2;
            font-size: 18px;
        }
         .creative-vertical .creative-subtitle { font-size: 24px; }

        .creative-description {
            line-height: 1.4;
            font-size: 14px;
        }
        .creative-vertical .creative-description { font-size: 16px; }

        .creative-accent { position: absolute; left: 0; width: 6px; background: white; border-radius: 0 3px 3px 0; z-index: 10; }
        .creative-vertical .creative-accent { top: 15%; height: 20%; width: 8px; }
        .creative:not(.creative-vertical) .creative-accent { top: 35%; height: 30%; width: 10px; }

        /* Badge para previsualización */
        .creative-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            z-index: 15;
            max-width: 40%;
            text-align: center;
            line-height: 1.2;
        }
         .creative-vertical .creative-badge {
             top: 6%;
             right: 30px;
             font-size: 11px;
         }

        .creative-download { position: absolute; top: 10px; right: 10px; width: 30px; height: 30px; border-radius: 50%; background: rgba(68, 68, 68, 0.8); display: flex; align-items: center; justify-content: center; cursor: pointer; opacity: 0; transition: opacity 0.3s; z-index: 20;}
        .creative:hover .creative-download { opacity: 1; }

        .note { text-align: center; margin-top: 30px; color: #666; font-size: 12px; }
        .info-box { background-color: #e6f7ff; border-left: 4px solid #1890ff; padding: 15px; margin: 20px auto; max-width: 800px; border-radius: 4px; display: flex; align-items: flex-start; }
        .info-box i { color: #1890ff; font-size: 20px; margin-right: 10px; margin-top: 2px; }
        .info-box p { color: #333; font-size: 14px; margin: 0; line-height: 1.5; }
        .format-toggle { text-align: center; margin: 20px 0; }
        .format-btn { padding: 8px 16px; border: 1px solid #ddd; border-radius: 4px; background-color: white; margin: 0 5px; cursor: pointer; transition: all 0.2s ease; }
        .format-btn.active { background-color: #ff7e00; color: white; border-color: #ff7e00; }
        .best-practices { background-color: #f8f8f8; border-radius: 8px; padding: 15px; margin: 20px 0; display: none; }
        .best-practices h3 { font-size: 16px; color: #333; margin-bottom: 10px; }
        .best-practices ul { list-style-type: disc; margin-left: 20px; }
        .best-practices li { font-size: 13px; margin-bottom: 5px; color: #666; }
        .toggle-practices { display: block; margin: 10px auto; background: none; border: 1px solid #ddd; padding: 5px 10px; font-size: 12px; color: #666; cursor: pointer; border-radius: 4px; }

        .logo-container { position: absolute; top: 15px; left: 15px; padding: 5px 10px; border-radius: 4px; z-index: 20; }
        .creative-vertical .logo-container { top: 6%; left: 40px; }

        /* Estilos Modal Carga y Canvas */
        .loading-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); display: none; justify-content: center; align-items: center; z-index: 9999; } /* display: none por defecto */
        .loading-container { background-color: #fff; padding: 20px 30px; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); text-align: center; }
        .loading-spinner { display: inline-block; width: 30px; height: 30px; border: 4px solid rgba(0,0,0,.1); border-radius: 50%; border-top-color: #ff7e00; animation: spin 1s ease-in-out infinite; margin-bottom: 10px; }
        @keyframes spin { to { transform: rotate(360deg); } }
        #downloadCanvas { position: absolute; left: -9999px; top: -9999px; }
        .text-20-indicator { padding: 8px 12px; font-size: 13px; background-color: rgba(255, 126, 0, 0.1); border: 1px solid #ff7e00; color: #666; margin: 10px 0; border-radius: 4px; text-align: center; }

        /* Ad Copy Section */
        .ad-copy-section { margin-top: 40px; border-top: 1px solid #eee; padding-top: 20px; }
        .ad-copy-section h3 { font-size: 18px; color: #333; text-align: center; margin-bottom: 15px; }
        .ad-copy-container { background-color: #f9f9f9; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); max-width: 800px; margin: 0 auto; }
        .ad-copy-text { font-size: 16px; line-height: 1.6; color: #444; white-space: pre-line; }
        .copy-btn { background: #f1f1f1; border: 1px solid #ddd; border-radius: 4px; padding: 8px 16px; font-size: 14px; color: #555; cursor: pointer; display: flex; align-items: center; justify-content: center; margin: 15px auto 0; transition: all 0.3s ease; }
        .copy-btn:hover { background: #e9e9e9; }
        .copy-btn i { margin-right: 8px; }
        .campaign-type-indicator { background-color: #f8fafa; border: 1px dashed #1890ff; border-radius: 4px; padding: 10px; margin: 15px 0; text-align: center; color: #1890ff; font-weight: 600; font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 8px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="serviceTitle">Creativos de Tráfico</h1>
            <p>Anuncios diseñados para maximizar tráfico (con Badge de Servicio)</p>
        </div>

        <div class="campaign-type-indicator">
            <i class="fas fa-globe"></i>
            <span>Campañas Optimizadas para Tráfico al Sitio Web</span>
        </div>

        <div class="tabs">
             <div class="tab-group">
                 <button class="tab-button auditoria" data-service="auditoria">Auditoría Gratis</button>
                 <button class="tab-button optimizacion active" data-service="optimizacion">Optimización Express</button>
                 <button class="tab-button meta" data-service="meta">Meta Ads</button>
                 <button class="tab-button google" data-service="google">Google Ads</button>
                 <button class="tab-button email" data-service="email">Email Marketing</button>
                 <button class="tab-button chatbot" data-service="chatbot">Chatbot</button>
                 <button class="tab-button all" data-service="all">Paquete Completo</button>
             </div>
         </div>

        <div class="format-toggle">
             <button id="squareBtn" class="format-btn active">Cuadrado (1080x1080)</button>
             <button id="verticalBtn" class="format-btn">Vertical (1080x1920)</button>
         </div>

        <div class="color-toggle">
             <div class="color-btn color-btn-original active" data-color="original" title="Color original del servicio"></div>
             <div class="color-btn color-btn-orange" data-color="orange" title="Fondo naranja"></div>
             <div class="color-btn color-btn-white" data-color="white" title="Fondo blanco"></div>
             <div class="color-btn color-btn-black" data-color="black" title="Fondo negro"></div>
         </div>

        <div class="download-section">
             <button id="downloadBtn" class="download-btn">
                 <i class="fas fa-download"></i>
                 Descargar Creativo
             </button>
         </div>

        <div class="info-box">
             <i class="fas fa-info-circle"></i>
             <div>
                 <p><strong>Instrucciones:</strong></p>
                 <p>1. Seleccioná el tipo de servicio que deseás generar.</p>
                 <p>2. Elegí el formato (cuadrado 1080x1080 o vertical 1080x1920).</p>
                 <p>3. Seleccioná el color de fondo (original, naranja, blanco o negro).</p>
                 <p>4. Hacé clic en "Descargar Creativo" para obtener la imagen en alta resolución.</p>
                 <p>5. También podés descargar el creativo pasando el mouse sobre la imagen y haciendo clic en el icono de descarga.</p>
             </div>
         </div>

        <div class="text-20-indicator">
             <i class="fas fa-check-circle" style="color: #00b300;"></i>
             Texto optimizado (menos del 20% del espacio) - Aprobado para Meta Ads
         </div>

        <div class="best-practices">
             <h3>Mejores Prácticas para Anuncios de Tráfico:</h3>
             <ul>
                 <li><strong>Mensajes intrigantes</strong> - Copy que genera curiosidad y fomenta el clic</li>
                 <li><strong>Imágenes de alto impacto</strong> - Elementos visuales llamativos que captan atención</li>
                 <li><strong>Menos del 20% de texto</strong> - Facebook penaliza anuncios con exceso de texto</li>
                 <li><strong>Colores contrastantes</strong> - Ajuste automático del contraste según el fondo seleccionado</li>
                 <li><strong>Mensajes de valor</strong> - Propuesta de valor clara sobre lo que encontrarán en el sitio</li>
                 <li><strong>Llamada a la acción clara</strong> - CTA enfocado en visitar, descubrir, explorar</li>
                 <li><strong>Composición centrada</strong> - Elementos principales visibles a primera vista</li>
             </ul>
         </div>
         <button class="toggle-practices" id="togglePractices">Ver mejores prácticas para tráfico</button>

        <div id="creativesContainer" class="creatives-container"></div>

        <div class="note">
            <p>Dimensiones: 1080x1080 píxeles y 1080x1920 píxeles (imágenes descargadas en alta resolución)</p>
            <p>El formato vertical respeta márgenes seguros para Instagram Stories.</p>
            <p>El texto destacado del servicio se muestra como un badge.</p>
        </div>

        <div class="ad-copy-section">
            <h3>Copy para Anuncio de Tráfico con Emojis (Voseo)</h3>
            <div class="ad-copy-container">
                <p id="adCopyText" class="ad-copy-text"></p>
                <button id="copyBtn" class="copy-btn">
                    <i class="fas fa-copy"></i> Copiar
                </button>
            </div>
        </div>

        <canvas id="downloadCanvas"></canvas>

        <!-- Modal de Carga (oculto por defecto) -->
        <div class="loading-modal" id="loadingModal">
            <div class="loading-container">
                <div class="loading-spinner"></div>
                <div id="loadingMessage">Generando imagen...</div>
            </div>
        </div>

    </div>

    <script>
        // --- START SCRIPT ---

        const colors = {
            primary: '#ff7e00', dark: '#181818', light: '#ffffff',
            auditoria: '#28a745', optimizacion: '#dc3545', meta: '#1877F2',
            google: '#4285F4', googleRed: '#DB4437', googleYellow: '#F4B400', googleGreen: '#0F9D58',
            email: '#00829b', chatbot: '#6f42c1'
        };

        // --- creativesData ACTUALIZADO ---
        const creativesData = {
             auditoria: {
                 title: '¿ADS QUE NO RINDEN?',
                 serviceHighlight: 'AUDITORÍA ADS GRATUITA',
                 subtitle: 'DESCUBRÍ FUGAS DE PRESUPUESTO',
                 description: 'Análisis experto Google y Meta\nEncontrá oportunidades ocultas',
                 bgColor: colors.auditoria
             },
             optimizacion: {
                 title: '¡DETENÉ LA PÉRDIDA YA!',
                 serviceHighlight: 'OPTIMIZACIÓN EXPRESS 48HS',
                 subtitle: 'CORREGIMOS TUS CAMPAÑAS',
                 description: 'Resultados rápidos en 48hs\nMaximizá tu inversión HOY',
                 bgColor: colors.optimizacion
             },
             meta: {
                 title: '¿FACEBOOK & IG NO VENDEN?',
                 serviceHighlight: 'GESTIÓN META ADS PRO',
                 subtitle: 'LLEGÁ A CLIENTES QUE COMPRAN',
                 description: 'Maximizamos tu ROI\nCreatividad que convierte',
                 bgColor: colors.meta
             },
             google: {
                 title: '¿INVISIBLE EN GOOGLE?',
                 serviceHighlight: 'GESTIÓN GOOGLE ADS PRO',
                 subtitle: 'CONECTÁ CON QUIEN TE BUSCA',
                 description: 'Keywords que convierten\nReducimos tu costo por clic',
                 bgColor: colors.google
             },
             email: {
                 title: '¿EMAILS QUE NADIE ABRE?',
                 serviceHighlight: 'EMAIL MARKETING AUTOMÁTICO',
                 subtitle: 'CONVERTÍ SUSCRIPTORES EN VENTAS',
                 description: 'Nutrición y ventas 24/7\nGenerá ingresos recurrentes',
                 bgColor: colors.email
             },
             chatbot: {
                 title: '¿PERDÉS VENTAS POR DEMORAR?',
                 serviceHighlight: 'CHATBOT INTELIGENTE 24/7',
                 subtitle: 'AUTOMATIZÁ RESPUESTAS Y LEADS',
                 description: 'Atención inmediata siempre\nMejorá experiencia y conversión',
                 bgColor: colors.chatbot
             },
             all: {
                 title: 'ESTRATEGIA DIGITAL TOTAL',
                 serviceHighlight: 'PAQUETE COMPLETO OV',
                 subtitle: 'AHORRÁ $200 Y POTENCIÁ TODO',
                 description: 'Ads + Email + Chatbot Juntos\nResultados integrados garantizados',
                 bgColor: '#333333'
             }
        };
        // --- FIN creativesData ---

        // Ad Copy Data (COMPLETO)
        const adCopyData = {
            auditoria: `🔍 ¿QUÉ ESTÁ FALLANDO EN TUS CAMPAÑAS DE MARKETING DIGITAL? 🔍\n\n¿Sabías que el 67% de las empresas invierten en publicidad sin comprender qué métricas realmente impactan sus ventas? 💡\n\nEstás a punto de descubrir por qué tu competencia consigue mejores resultados con el mismo presupuesto...\n\n✅ Análisis completo de tus campañas actuales\n✅ Identificación exacta de dónde estás perdiendo dinero\n✅ Comparativa con estrategias de competidores exitosos\n✅ 100% gratis y sin compromiso de contratación\n\n👉 Visitá nuestra web y descubrí qué oportunidades de crecimiento estás dejando pasar mientras leés esto.\n\nLa auditoría gratuita tiene cupos limitados cada semana. ¿Por qué esperar?\n\n➡️ www.orangevapor.com`,
            optimizacion: `⚡ TRANSFORMÁ TUS CAMPAÑAS QUE NO CONVIERTEN EN SOLO 48 HORAS ⚡\n\nCada día con campañas mal optimizadas significa dinero perdido y oportunidades desaprovechadas... 💸\n\nNuestro sistema de "Detección de Fugas™" ha revelado que:\n\n✅ El 63% del presupuesto se desperdicia en configuraciones incorrectas\n✅ La segmentación imprecisa es la principal causa de CPA elevados\n✅ La mayoría de las campañas necesitan solo 3 ajustes clave para aumentar ventas\n\n👉 En nuestro sitio web encontrarás cómo transformamos las campañas de una tienda online, aumentando sus ventas un 20% en solo 14 días.\n\nDiagnóstico + Estructura optimizada con garantía de resultados o solo pagás la mitad.\n\n¿Querés detener el sangrado presupuestario ahora? Visitá 👇\nwww.orangevapor.com`,
            meta: `📱 MULTIPLICÁ TUS VENTAS CON META ADS QUE CONVIERTEN 📱\n\n¿De cada $1 invertido en tus Facebook & Instagram Ads, cuánto recuperás en ventas reales? 🤔\n\nNuestros clientes obtienen MÍNIMO $2.8 por cada $1 invertido...\n\n✅ 2.8x ROAS mínimo garantizado o te devolvemos tu dinero\n✅ 35% reducción promedio en costo por adquisición\n✅ 45% más conversiones con la misma inversión\n✅ Gestión profesional que maximiza cada peso invertido\n\n👉 En nuestro sitio web podrás ver cómo una tienda de moda online aumentó su ROAS de 1.2x a 3.4x en solo 3 meses.\n\nCampañas estructuradas y optimizadas específicamente para tu negocio.\n\n¿Querés aprovechar el verdadero potencial de Meta Ads? Hacé clic ahora 👇\nwww.orangevapor.com`,
            google: `🔎 CONVERTÍ BÚSQUEDAS EN VENTAS REALES CON GOOGLE ADS 🔎\n\nMientras tus competidores aparecen en los primeros resultados de Google, ¿dónde está tu negocio? 👀\n\nDescubrí cómo posicionarte estratégicamente con:\n\n✅ 2.8x ROAS mínimo garantizado o te devolvemos tu dinero\n✅ Investigación de palabras clave rentables para tu industria\n✅ Optimización semanal de pujas y presupuestos\n✅ Análisis de competencia para detectar oportunidades ocultas\n\n👉 En nuestro sitio web verás cómo una empresa de servicios profesionales aumentó sus leads calificados un 190% y redujo su costo de adquisición un 38%.\n\nGoogle Ads gestionado por expertos con resultados medibles.\n\nPosicioná tu negocio donde tus clientes están buscando 👇\nwww.orangevapor.com`,
            email: `📧 EMAIL MARKETING QUE GENERA INGRESOS AUTOMÁTICOS 24/7 📧\n\n¿Sabías que el email marketing ofrece el mayor ROI de todos los canales digitales (3600% en promedio)? 📈\n\nTu base de datos es uno de tus activos más valiosos. ¿Lo estás aprovechando?\n\n✅ 38% promedio de tasa de apertura (vs. 15% estándar de la industria)\n✅ Secuencias automatizadas que convierten prospectos en clientes\n✅ Segmentación estratégica basada en comportamiento real\n✅ Ingresos recurrentes, incluso mientras dormís\n\n👉 En nuestro sitio web conocerás cómo una boutique de cosmética natural aumentó sus ingresos mensuales por email de $400 a $4,800 en poco tiempo.\n\nNurturing automatizado que monetiza cada contacto en tu base de datos.\n\nDescubrí cómo transformar tu email marketing hoy mismo 👇\nwww.orangevapor.com`,
            chatbot: `🤖 ATENCIÓN AL CLIENTE AUTOMATIZADA QUE GENERA VENTAS 24/7 🤖\n\n¿Cuántos leads y ventas perdés cuando tu equipo no puede responder inmediatamente? ⏰\n\nLos chatbots inteligentes están revolucionando la atención al cliente:\n\n✅ Atención instantánea 24/7, incluso fuera de horario comercial\n✅ Reducción de hasta 70% en costos de atención al cliente\n✅ Captura datos de clientes potenciales mientras dormís\n✅ Respuestas en 5 minutos vs. 48 horas de atención humana\n\n👉 En nuestro sitio web verás cómo una tienda redujo su tiempo de respuesta de 2 días a 10 minutos y aumentó su tasa de conversión del 22% al 68%.\n\nChatbots inteligentes que maximizan tus resultados mientras liberan a tu equipo.\n\n¿Listo para nunca más perder una oportunidad de venta? 👇\nwww.orangevapor.com`,
            all: `🚀 MULTIPLICÁ TUS RESULTADOS CON MARKETING DIGITAL INTEGRADO 🚀\n\n¿Por qué conformarte con resultados mediocres cuando podés tener una estrategia digital completa? 🔄\n\nEl paquete integral que está transformando negocios incluye:\n\n✅ Meta Ads: 2.8x ROAS mínimo garantizado\n✅ Google Ads: Posicionamiento estratégico que convierte\n✅ Email Marketing: 38% de tasa de apertura promedio\n✅ Chatbot: Atención 24/7 y captura de leads automática\n\n👉 En nuestro sitio web descubrirás cómo ahorrarte casi $200 al mes contratando nuestro paquete completo por solo $1000/mes.\n\nEstrategias digitales diseñadas con un único objetivo: maximizar tu ROI.\n\nPotenciá todos los canales de tu negocio con un solo clic 👇\nwww.orangevapor.com`
        };

        let activeService = 'optimizacion';
        let activeFormat = 'square';
        let activeColor = 'original';
        let isProcessing = false;

        const serviceTitle = document.getElementById('serviceTitle');
        const creativesContainer = document.getElementById('creativesContainer');
        const tabButtons = document.querySelectorAll('.tab-button');
        const formatButtons = document.querySelectorAll('.format-btn');
        const colorButtons = document.querySelectorAll('.color-btn');
        const squareBtn = document.getElementById('squareBtn');
        const verticalBtn = document.getElementById('verticalBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const togglePracticesBtn = document.getElementById('togglePractices');
        const bestPracticesBox = document.querySelector('.best-practices');
        const downloadCanvas = document.getElementById('downloadCanvas');
        const adCopyText = document.getElementById('adCopyText');
        const copyBtn = document.getElementById('copyBtn');

        // --- FUNCIONES AUXILIARES ---
        copyBtn.addEventListener('click', () => {
             const textToCopy = adCopyText.innerText;
             navigator.clipboard.writeText(textToCopy).then(() => {
                 copyBtn.innerHTML = '<i class="fas fa-check"></i> Copiado!';
                 setTimeout(() => { copyBtn.innerHTML = '<i class="fas fa-copy"></i> Copiar'; }, 2000);
             }).catch(err => {
                 console.error('Error al copiar: ', err);
                 copyBtn.innerHTML = '<i class="fas fa-times"></i> Error';
                 setTimeout(() => { copyBtn.innerHTML = '<i class="fas fa-copy"></i> Copiar'; }, 2000);
             });
        });

        togglePracticesBtn.addEventListener('click', () => {
            const isHidden = bestPracticesBox.style.display === 'none';
            bestPracticesBox.style.display = isHidden ? 'block' : 'none';
            togglePracticesBtn.textContent = isHidden ? 'Ocultar mejores prácticas' : 'Ver mejores prácticas para tráfico';
        });

        function getServiceTitle(service) {
            return `Creativos de Tráfico para ${creativesData[service]?.serviceHighlight || 'Servicio Desconocido'}`;
        }

        function getBgColor() {
            if (activeColor === 'original') return creativesData[activeService].bgColor;
            if (activeColor === 'orange') return colors.primary;
            if (activeColor === 'white') return colors.light;
            if (activeColor === 'black') return colors.dark;
            return creativesData[activeService].bgColor;
        }

        function getTextColor(bgColor) {
            try {
                let rgb;
                if (bgColor.startsWith('#')) {
                    const bigint = parseInt(bgColor.slice(1), 16);
                    rgb = { r: (bigint >> 16) & 255, g: (bigint >> 8) & 255, b: bigint & 255 };
                } else if (bgColor.startsWith('rgb')) {
                    const matches = bgColor.match(/\d+/g);
                    if (!matches || matches.length < 3) return colors.dark;
                    rgb = { r: parseInt(matches[0]), g: parseInt(matches[1]), b: parseInt(matches[2]) };
                } else { return colors.dark; }
                const luminance = (0.299 * rgb.r + 0.587 * rgb.g + 0.114 * rgb.b) / 255;
                return luminance > 0.5 ? colors.dark : colors.light;
            } catch (e) { console.error("Error calculando color de texto para:", bgColor, e); return colors.dark; }
        }

        function getAccentColor(bgColor) {
            const mainTextColor = getTextColor(bgColor);
            return mainTextColor === colors.dark ? colors.primary : colors.light;
        }

        function showLoadingModal(message = "Generando imagen...") {
             let modal = document.getElementById('loadingModal');
             if (modal) {
                 document.getElementById('loadingMessage').textContent = message;
                 modal.style.display = 'flex';
             }
        }
        function hideLoadingModal() {
            const modal = document.getElementById('loadingModal');
            if (modal) modal.style.display = 'none';
        }

        // --- RENDERIZADO Y DIBUJO ---
        function renderCreative() {
            creativesContainer.innerHTML = '';
            const creative = creativesData[activeService];
            const bgColor = getBgColor();
            const textColor = getTextColor(bgColor);
            const accentColor = getAccentColor(bgColor);
            const badgeBgColor = accentColor;
            const badgeTextColor = getTextColor(badgeBgColor);

            const creativeEl = document.createElement('div');
            creativeEl.className = `creative ${activeFormat === 'vertical' ? 'creative-vertical' : ''}`;
            creativeEl.style.backgroundColor = bgColor;

            const contentEl = document.createElement('div');
            contentEl.className = 'creative-content';
             if (activeFormat === 'vertical') { contentEl.style.paddingTop = '20%'; contentEl.style.paddingBottom = '15%'; contentEl.style.justifyContent = 'flex-start'; }
             else { contentEl.style.justifyContent = 'center'; }

            const accentEl = document.createElement('div');
            accentEl.className = 'creative-accent';
            accentEl.style.background = accentColor;
            creativeEl.appendChild(accentEl);

            const logoContainerEl = document.createElement('div');
            logoContainerEl.className = 'logo-container';
            const logoEl = document.createElement('div');
            logoEl.style.fontWeight = 'bold';
            logoEl.style.fontSize = activeFormat === 'vertical' ? '18px' : '14px';
            if (activeColor === 'white') { logoEl.innerHTML = `<span style="color: ${colors.dark};">Orange</span> <span style="color: ${colors.primary};">Vapor</span>`; }
            else if (activeColor === 'orange') { logoEl.innerHTML = `<span style="color: ${colors.light};">Orange Vapor</span>`; }
            else { logoEl.innerHTML = `<span style="color: ${textColor};">Orange</span> <span style="color: ${colors.primary};">Vapor</span>`; }
            logoContainerEl.appendChild(logoEl);
            creativeEl.appendChild(logoContainerEl);

             const badgeEl = document.createElement('div');
             badgeEl.className = 'creative-badge';
             badgeEl.textContent = creative.serviceHighlight.toUpperCase();
             badgeEl.style.backgroundColor = badgeBgColor;
             badgeEl.style.color = badgeTextColor;
             creativeEl.appendChild(badgeEl);

            const titleEl = document.createElement('div');
            titleEl.className = 'creative-title';
            titleEl.style.fontSize = activeFormat === 'vertical' ? '28px' : '22px';
            titleEl.textContent = creative.title;
            titleEl.style.color = textColor;
            contentEl.appendChild(titleEl);

            const subtitleEl = document.createElement('div');
            subtitleEl.className = 'creative-subtitle';
            subtitleEl.style.fontSize = activeFormat === 'vertical' ? '24px' : '18px';
            subtitleEl.textContent = creative.subtitle;
            subtitleEl.style.color = textColor;
            contentEl.appendChild(subtitleEl);

            const descEl = document.createElement('div');
            descEl.className = 'creative-description';
            descEl.style.fontSize = activeFormat === 'vertical' ? '16px' : '14px';
            descEl.style.whiteSpace = 'pre-line';
            descEl.textContent = creative.description;
            descEl.style.color = textColor;
            contentEl.appendChild(descEl);

            creativeEl.appendChild(contentEl);

            const downloadEl = document.createElement('div');
            downloadEl.className = 'creative-download';
            downloadEl.innerHTML = '<i class="fas fa-download" style="color: white;"></i>';
            downloadEl.addEventListener('click', (e) => { e.stopPropagation(); generateAndDownloadImage(); });
            creativeEl.appendChild(downloadEl);

            creativeEl.addEventListener('click', generateAndDownloadImage);
            creativesContainer.appendChild(creativeEl);
            updateAdCopy();
        }

        function drawBadge(ctx, text, isVertical, width, height, safeZoneTop) {
             const badgePaddingX = 25;
             const badgePaddingY = 15;
             const badgeFontSize = isVertical ? 32 : 28;
             const badgeText = text.toUpperCase();
             const badgeMarginX = isVertical ? 60 : 40;
             const badgeMarginY = isVertical ? safeZoneTop + 20 : 40;

             const badgeBgColor = getAccentColor(getBgColor());
             const badgeTextColor = getTextColor(badgeBgColor);

             ctx.font = `600 ${badgeFontSize}px Montserrat, sans-serif`;
             ctx.textAlign = 'center';

             const textMetrics = ctx.measureText(badgeText);
             const maxBadgeWidth = width * 0.5;
             const badgeWidth = Math.min(textMetrics.width + badgePaddingX * 2, maxBadgeWidth);
             const badgeHeight = badgeFontSize + badgePaddingY * 2;

             const badgeX = width - badgeWidth - badgeMarginX;
             const badgeY = badgeMarginY;

             ctx.fillStyle = badgeBgColor;
             const borderRadius = 8;
             ctx.beginPath();
             ctx.moveTo(badgeX + borderRadius, badgeY); ctx.lineTo(badgeX + badgeWidth - borderRadius, badgeY); ctx.quadraticCurveTo(badgeX + badgeWidth, badgeY, badgeX + badgeWidth, badgeY + borderRadius); ctx.lineTo(badgeX + badgeWidth, badgeY + badgeHeight - borderRadius); ctx.quadraticCurveTo(badgeX + badgeWidth, badgeY + badgeHeight, badgeX + badgeWidth - borderRadius, badgeY + badgeHeight); ctx.lineTo(badgeX + borderRadius, badgeY + badgeHeight); ctx.quadraticCurveTo(badgeX, badgeY + badgeHeight, badgeX, badgeY + badgeHeight - borderRadius); ctx.lineTo(badgeX, badgeY + borderRadius); ctx.quadraticCurveTo(badgeX, badgeY, badgeX + borderRadius, badgeY);
             ctx.closePath(); ctx.fill();

             ctx.fillStyle = badgeTextColor;
             const textY = badgeY + badgeHeight / 2 + badgeFontSize * 0.35;
             if (textMetrics.width + badgePaddingX * 2 <= maxBadgeWidth) { ctx.fillText(badgeText, badgeX + badgeWidth / 2, textY); }
             else { console.warn("Texto del badge demasiado largo:", badgeText); }
        }

        function generateAndDownloadImage() {
            if (isProcessing) return;
            isProcessing = true;
            showLoadingModal();

            setTimeout(() => {
                try {
                    const creative = creativesData[activeService];
                    const isVertical = activeFormat === 'vertical';
                    const width = 1080;
                    const height = isVertical ? 1920 : 1080;

                    downloadCanvas.width = width;
                    downloadCanvas.height = height;
                    const ctx = downloadCanvas.getContext('2d');
                    ctx.clearRect(0, 0, width, height);

                    const bgColor = getBgColor();
                    const textColor = getTextColor(bgColor);
                    const accentColor = getAccentColor(bgColor);

                    // PASO 1: Fondo
                    ctx.fillStyle = bgColor; ctx.fillRect(0, 0, width, height);

                    // PASO 2: Acento Lateral
                    ctx.fillStyle = accentColor; const accentWidth = isVertical ? 15 : 10; const accentHeightRatio = isVertical ? 0.25 : 0.30; const accentTopRatio = isVertical ? 0.18 : 0.35; ctx.fillRect(0, height * accentTopRatio, accentWidth, height * accentHeightRatio);

                    // PASO 3: Logo
                    const logoFontSize = isVertical ? 48 : 36; ctx.font = `bold ${logoFontSize}px Montserrat, sans-serif`; const logoMargin = isVertical ? 80 : 40; const logoX = logoMargin; const logoY = isVertical ? Math.max(logoMargin, Math.round(height * 0.07)) : logoMargin; ctx.textAlign = 'left';
                    if (activeColor === 'white') { ctx.fillStyle = '#181818'; ctx.fillText('Orange', logoX, logoY); const orangeWidth = ctx.measureText('Orange ').width; ctx.fillStyle = '#FF7E00'; ctx.fillText('Vapor', logoX + orangeWidth, logoY); }
                    else if (activeColor === 'orange') { ctx.fillStyle = 'white'; ctx.fillText('Orange Vapor', logoX, logoY); }
                    else { ctx.fillStyle = textColor; ctx.fillText('Orange', logoX, logoY); const orangeWidth = ctx.measureText('Orange ').width; ctx.fillStyle = '#FF7E00'; ctx.fillText('Vapor', logoX + orangeWidth, logoY); }

                    // PASO 4: Badge
                    const safeZoneTop = height * 0.15;
                    drawBadge(ctx, creative.serviceHighlight, isVertical, width, height, safeZoneTop);

                    // PASO 5: Texto Principal
                    ctx.textAlign = 'center'; const contentPaddingX = 100; const textMaxWidth = width - (contentPaddingX * 2); const contentCenterY = isVertical ? safeZoneTop + (height - safeZoneTop * 2) / 2 : height / 2; const titleYOffset = isVertical ? -120 : -80; const subtitleYOffset = isVertical ? 0 : 30; const descYOffset = isVertical ? 100 : 110; const lineSpacingMultiplier = isVertical ? 1.4 : 1.3; let currentY;

                    // 5.1 Título
                    ctx.fillStyle = textColor; const titleFontSize = isVertical ? 80 : 70; const titleLineHeight = titleFontSize * 1.1; ctx.font = `800 ${titleFontSize}px Montserrat, sans-serif`; currentY = contentCenterY + titleYOffset; currentY = wrapText(ctx, creative.title, width / 2, currentY, textMaxWidth, titleLineHeight);

                    // 5.2 Subtítulo
                    const subtitleFontSize = isVertical ? 56 : 46; const subtitleLineHeight = subtitleFontSize * 1.15; ctx.font = `bold ${subtitleFontSize}px Montserrat, sans-serif`; currentY = contentCenterY + subtitleYOffset; currentY = wrapText(ctx, creative.subtitle, width / 2, currentY, textMaxWidth, subtitleLineHeight);

                    // 5.3 Descripción
                    const descFontSize = isVertical ? 42 : 36; const descLineHeight = descFontSize * lineSpacingMultiplier; ctx.font = `400 ${descFontSize}px Montserrat, sans-serif`; currentY = contentCenterY + descYOffset; wrapText(ctx, creative.description, width / 2, currentY, textMaxWidth, descLineHeight);

                    // PASO 6: Descargar Imagen
                    setTimeout(() => {
                        try {
                             const dataUrl = downloadCanvas.toDataURL('image/png'); const link = document.createElement('a'); link.href = dataUrl; link.download = `orangevapor-trafico-${activeService}-${activeColor}-${activeFormat}-badge.png`; document.body.appendChild(link); link.click(); document.body.removeChild(link); hideLoadingModal(); isProcessing = false;
                        } catch (downloadError) { console.error('Error al descargar:', downloadError); hideLoadingModal(); alert('Error al descargar.'); isProcessing = false; }
                    }, 500);

                } catch (generationError) { console.error('Error al generar:', generationError); hideLoadingModal(); alert('Error al generar.'); isProcessing = false; }
            }, 100);
        }

        function wrapText(ctx, text, x, y, maxWidth, lineHeight) {
            const lines = text.split('\n');
            let currentY = y;
            lines.forEach(linePart => {
                const words = linePart.split(' ');
                let line = '';
                for (let n = 0; n < words.length; n++) {
                    const testLine = line + words[n] + ' ';
                    const metrics = ctx.measureText(testLine);
                    if (metrics.width > maxWidth && n > 0) {
                        ctx.fillText(line.trim(), x, currentY);
                        line = words[n] + ' ';
                        currentY += lineHeight;
                    } else { line = testLine; }
                }
                ctx.fillText(line.trim(), x, currentY);
                currentY += lineHeight;
            });
            // Quitamos el último incremento innecesario para devolver la Y de la base de la última línea
            return currentY - lineHeight + (lineHeight * 0.2); // Ajuste pequeño para siguiente elemento
        }


        // --- ACTUALIZACIÓN UI Y EVENTOS ---
        function updateUI() {
            serviceTitle.textContent = getServiceTitle(activeService);
            tabButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.service === activeService));
            formatButtons.forEach(btn => btn.classList.toggle('active', btn.id === (activeFormat === 'square' ? 'squareBtn' : 'verticalBtn')));
            colorButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.color === activeColor));
            renderCreative();
        }

        function updateAdCopy() {
            adCopyText.textContent = adCopyData[activeService] || "Copy no disponible.";
            copyBtn.innerHTML = '<i class="fas fa-copy"></i> Copiar'; // Reset copy button
        }

        tabButtons.forEach(btn => btn.addEventListener('click', () => { activeService = btn.dataset.service; updateUI(); }));
        squareBtn.addEventListener('click', () => { activeFormat = 'square'; updateUI(); });
        verticalBtn.addEventListener('click', () => { activeFormat = 'vertical'; updateUI(); });
        colorButtons.forEach(btn => btn.addEventListener('click', () => { activeColor = btn.dataset.color; updateUI(); }));
        downloadBtn.addEventListener('click', generateAndDownloadImage);

        // Inicializar
        updateUI();

        // --- END SCRIPT ---
    </script>
</body>
</html>
