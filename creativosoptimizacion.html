<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creativos Orange Vapor - Optimizados</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            font-size: 28px;
            color: #2c2c2c;
            margin-bottom: 10px;
        }
        .header p {
            color: #666;
            font-size: 16px;
        }
        .tabs {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        .tab-group {
            display: inline-flex;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
        }
        .tab-button {
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 500;
            background-color: white;
            color: #333;
            border: 1px solid #ddd;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .tab-button:first-child {
            border-top-left-radius: 6px;
            border-bottom-left-radius: 6px;
        }
        .tab-button:last-child {
            border-top-right-radius: 6px;
            border-bottom-right-radius: 6px;
        }
        .tab-button.active {
            color: white;
        }
        .tab-button.optimizacion.active {
            background-color: #dc3545;
            border-color: #dc3545;
        }
        .tab-button.meta.active {
            background-color: #1877F2;
            border-color: #1877F2;
        }
        .tab-button.google.active {
            background-color: #4285F4;
            border-color: #4285F4;
        }
        .tab-button.email.active {
            background-color: #00829b;
            border-color: #00829b;
        }
        .tab-button.chatbot.active {
            background-color: #6f42c1;
            border-color: #6f42c1;
        }
        .tab-button.all.active {
            background-color: #333333;
            border-color: #333333;
        }
        .download-section {
            text-align: center;
            margin: 20px 0;
        }
        .download-btn {
            background: #ff7e00;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 6px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 8px rgba(255, 126, 0, 0.3);
            transition: all 0.3s ease;
        }
        .download-btn:hover {
            background: #e67300;
            transform: translateY(-2px);
        }
        .creatives-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 20px;
        }
        .creative {
            width: 300px;
            height: 300px;
            margin: 10px;
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            color: white;
        }
        .creative-vertical {
            width: 200px;
            height: 356px;
        }
        .creative-content {
            position: relative;
            z-index: 2;
            padding: 20px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .creative-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
            line-height: 1.2;
        }
        .creative-subtitle {
            font-size: 16px;
            font-weight: bold;
            background: rgba(0,0,0,0.25);
            padding: 8px 12px;
            display: inline-block;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .creative-description {
            font-size: 14px;
            opacity: 0.9;
        }
        .creative-accent {
            position: absolute;
            left: 0;
            top: 30%;
            width: 6px;
            height: 100px;
            background: white;
            border-radius: 0 3px 3px 0;
            z-index: 10;
        }
        .creative-number {
            position: absolute;
            bottom: 12px;
            right: 12px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            z-index: 10;
        }
        .creative-download {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 10;
        }
        .creative:hover .creative-download {
            opacity: 1;
        }
        .note {
            text-align: center;
            margin-top: 30px;
            color: #666;
            font-size: 12px;
        }
        .info-box {
            background-color: #e6f7ff;
            border-left: 4px solid #1890ff;
            padding: 15px;
            margin: 20px auto;
            max-width: 800px;
            border-radius: 4px;
            display: flex;
            align-items: flex-start;
        }
        .info-box i {
            color: #1890ff;
            font-size: 20px;
            margin-right: 10px;
            margin-top: 2px;
        }
        .info-box p {
            color: #333;
            font-size: 14px;
            margin: 0;
            line-height: 1.5;
        }
        .format-toggle {
            text-align: center;
            margin: 20px 0;
        }
        .format-btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: white;
            margin: 0 5px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .format-btn.active {
            background-color: #ff7e00;
            color: white;
            border-color: #ff7e00;
        }
        .best-practices {
            background-color: #f8f8f8;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        .best-practices h3 {
            font-size: 16px;
            color: #333;
            margin-bottom: 10px;
        }
        .best-practices ul {
            list-style-type: disc;
            margin-left: 20px;
        }
        .best-practices li {
            font-size: 13px;
            margin-bottom: 5px;
            color: #666;
        }
        .toggle-practices {
            display: block;
            margin: 10px auto;
            background: none;
            border: 1px solid #ddd;
            padding: 5px 10px;
            font-size: 12px;
            color: #666;
            cursor: pointer;
            border-radius: 4px;
        }
        /* Nuevo estilo para el fondo del logo */
        .logo-container {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 5px 10px;
            border-radius: 4px;
            background-color: rgba(0, 0, 0, 0.3);
            z-index: 20;
        }

        /* Estilos para el visualizador grande */
        #fullSizeViewer {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            display: none;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        .fullsize-square {
            width: 600px;
            height: 600px;
        }
        .fullsize-vertical {
            width: 400px;
            height: 711px;
        }
        #fullSizeOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 999;
            display: none;
        }
        #closeViewer, #downloadImage {
            position: absolute;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 12px;
            cursor: pointer;
            z-index: 1001;
        }
        #closeViewer {
            top: 10px;
            right: 10px;
        }
        #downloadImage {
            bottom: 10px;
            right: 10px;
        }
        #status {
            background-color: #f8d7da;
            color: #721c24;
            padding: 10px;
            margin: 10px auto;
            border-radius: 4px;
            max-width: 800px;
            text-align: center;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="serviceTitle">Creativos para Optimización Express</h1>
            <p>Creativos para campañas de Orange Vapor</p>
        </div>
        
        <!-- Status para mensajes de error -->
        <div id="status"></div>
        
        <!-- Tabs de servicios -->
        <div class="tabs">
            <div class="tab-group">
                <button class="tab-button optimizacion active" data-service="optimizacion">Optimización Express</button>
                <button class="tab-button meta" data-service="meta">Meta Ads</button>
                <button class="tab-button google" data-service="google">Google Ads</button>
                <button class="tab-button email" data-service="email">Email Marketing</button>
                <button class="tab-button chatbot" data-service="chatbot">Chatbot</button>
                <button class="tab-button all" data-service="all">Paquete Completo</button>
            </div>
        </div>
        
        <!-- Selector de formato -->
        <div class="format-toggle">
            <button id="squareBtn" class="format-btn active">Cuadrado (1080x1080)</button>
            <button id="verticalBtn" class="format-btn">Vertical (1080x1920)</button>
        </div>
        
        <!-- Sección de descarga -->
        <div class="download-section">
            <button id="downloadBtn" class="download-btn">
                <i class="fas fa-download"></i>
                Descargar Creativos
            </button>
        </div>
        
        <!-- Mensaje informativo -->
        <div class="info-box">
            <i class="fas fa-info-circle"></i>
            <div>
                <p><strong>Instrucciones:</strong></p>
                <p>1. Selecciona el tipo de servicio que deseas generar.</p>
                <p>2. Elige el formato (cuadrado 1080x1080 o vertical 1080x1920).</p>
                <p>3. Haz clic en un creativo para previsualizarlo y luego en "Descargar" para obtenerlo en alta resolución.</p>
                <p>4. También puedes descargar todos los creativos haciendo clic en "Descargar Creativos".</p>
            </div>
        </div>
        
        <!-- Mejores prácticas (colapsable) -->
        <div class="best-practices" style="display: none;">
            <h3>Mejores Prácticas Aplicadas:</h3>
            <ul>
                <li><strong>Menos del 20% de texto</strong> - Facebook penaliza anuncios con exceso de texto</li>
                <li><strong>Zonas seguras</strong> - 14% superior e inferior en formato vertical libres de elementos clave</li>
                <li><strong>Tipografía ampliada</strong> - Mayor legibilidad en dispositivos móviles</li>
                <li><strong>Colores contrastantes</strong> - Mejor visualización y reconocimiento de marca</li>
                <li><strong>Composición centrada</strong> - Elementos principales visibles a primera vista</li>
                <li><strong>Logo consistente</strong> - Siempre en esquina superior izquierda con fondo para mejor contraste</li>
                <li><strong>Elementos visuales</strong> - Iconos y patrones específicos por servicio</li>
            </ul>
        </div>
        <button class="toggle-practices" id="togglePractices">Ver mejores prácticas aplicadas</button>
        
        <!-- Contenedor de creativos -->
        <div id="creativesContainer" class="creatives-container">
            <!-- Los creativos se insertan dinámicamente aquí -->
        </div>
        
        <!-- Nota de especificaciones -->
        <div class="note">
            <p>Dimensiones: 1080x1080 píxeles y 1080x1920 píxeles (imágenes descargadas en alta resolución)</p>
        </div>

        <!-- Visor a tamaño completo -->
        <div id="fullSizeOverlay"></div>
        <div id="fullSizeViewer">
            <button id="closeViewer"><i class="fas fa-times"></i></button>
            <button id="downloadImage"><i class="fas fa-download"></i> Descargar</button>
        </div>
        
        <!-- Canvas para generación de imágenes (oculto) -->
        <canvas id="exportCanvas" style="display:none;"></canvas>
    </div>
    
    <script>
        // Colores actualizados para cada servicio
        const colors = {
            primary: '#ff7e00', // Naranja original
            dark: '#181818',
            light: '#ffffff',
            // Nuevos colores
            optimizacion: '#dc3545', // Rojo para Optimización Express
            meta: '#1877F2',      // Azul para Meta Ads
            google: '#4285F4',    // Azul de Google
            googleRed: '#DB4437', // Rojo de Google 
            googleYellow: '#F4B400', // Amarillo de Google
            googleGreen: '#0F9D58', // Verde de Google
            email: '#00829b',     // Verde azulado para Email Marketing
            chatbot: '#6f42c1'    // Lila para Chatbot
        };
        
        // Datos de creativos optimizados (textos acortados para formato vertical)
        const creativesData = {
            optimizacion: [
                {
                    title: 'TRANSFORMÁ TUS CAMPAÑAS', // Acortado de "Transformamos"
                    subtitle: '+20% EN VENTAS',
                    description: 'Diagnóstico + Nueva estructura optimizada',
                    bgColor: colors.optimizacion,
                    icon: 'fa-solid fa-rocket' // Icono de cohete para optimización
                },
                {
                    title: 'EL PROBLEMA',
                    subtitle: 'SIN RESULTADOS',  // Acortado de "CAMPAÑAS SIN RESULTADOS"
                    description: 'Perdés ventas mientras la competencia avanza',
                    bgColor: colors.dark,
                    accentColor: colors.optimizacion,
                    icon: 'fa-solid fa-triangle-exclamation' // Icono de advertencia
                },
                {
                    title: 'LA SOLUCIÓN',
                    subtitle: 'OPTIMIZACIÓN',  // Acortado de "OPTIMIZACIÓN EXPRESS"
                    description: 'Estructura renovada que genera ventas reales',
                    bgColor: colors.dark,
                    accentColor: colors.optimizacion,
                    icon: 'fa-solid fa-lightbulb' // Icono de idea
                },
                {
                    title: 'INVERSIÓN ÚNICA',
                    subtitle: '$299 USD',
                    description: 'Pagá la mitad si no aumentamos tus ventas',
                    bgColor: colors.dark,
                    accentColor: colors.optimizacion,
                    icon: 'fa-solid fa-sack-dollar' // Icono de dinero
                }
            ],
            meta: [
                {
                    title: 'META ADS',
                    subtitle: 'CONVERSIONES',  // Acortado de "CONVERSIONES MAXIMIZADAS"
                    description: 'Estrategias personalizadas de alto retorno',
                    bgColor: colors.meta,
                    icon: 'fa-brands fa-facebook' // Icono de Facebook
                },
                {
                    title: 'TARGETING PRECISO',
                    subtitle: 'LLEGA A TU PÚBLICO',  // Cambiado de "AUDIENCIA" a "PÚBLICO"
                    description: 'Segmentación avanzada por intereses',
                    bgColor: colors.dark,
                    accentColor: colors.meta,
                    icon: 'fa-solid fa-bullseye' // Icono de diana
                },
                {
                    title: 'ANUNCIOS CREATIVOS',
                    subtitle: 'QUE CONVIERTEN',  // Acortado
                    description: 'Anuncios dinámicos para cada etapa',
                    bgColor: colors.dark,
                    accentColor: colors.meta,
                    icon: 'fa-solid fa-palette' // Icono de paleta
                },
                {
                    title: 'RESULTADOS MEDIBLES',
                    subtitle: 'DATA-DRIVEN',  // Acortado
                    description: 'Optimización constante de anuncios',
                    bgColor: colors.dark,
                    accentColor: colors.meta,
                    icon: 'fa-solid fa-chart-line' // Icono de gráfico
                }
            ],
            google: [
                {
                    title: 'GOOGLE ADS',
                    subtitle: 'CLIENTES ACTIVOS',  // Acortado de "CLIENTES QUE TE BUSCAN"
                    description: 'Campañas optimizadas para convertir',
                    bgColor: colors.google,
                    icon: 'fa-brands fa-google' // Icono de Google
                },
                {
                    title: 'BÚSQUEDA AVANZADA',
                    subtitle: 'TOP RESULTADOS',  // Acortado de "PRIMEROS RESULTADOS"
                    description: 'Palabras clave con intención de compra',
                    bgColor: colors.dark,
                    accentColor: colors.google,
                    icon: 'fa-solid fa-magnifying-glass' // Icono de búsqueda
                },
                {
                    title: 'DISPLAY & YOUTUBE',  // Acortado de "RED DISPLAY & YOUTUBE"
                    subtitle: 'PRESENCIA',  // Acortado de "PRESENCIA IMPACTANTE"
                    description: 'Anuncios gráficos y videos efectivos',
                    bgColor: colors.dark,
                    accentColor: colors.googleRed,
                    icon: 'fa-brands fa-youtube' // Icono de YouTube
                },
                {
                    title: 'ANÁLISIS',  // Acortado de "ANÁLISIS Y OPTIMIZACIÓN"
                    subtitle: 'MEJORA CONSTANTE',
                    description: 'Machine learning para maximizar conversiones',
                    bgColor: colors.dark,
                    accentColor: colors.googleYellow,
                    icon: 'fa-solid fa-chart-pie' // Icono de gráfico circular
                }
            ],
            email: [
                {
                    title: 'EMAIL MARKETING',
                    subtitle: 'CONEXIÓN DIRECTA',
                    description: 'Campañas que generan ventas',
                    bgColor: colors.email,
                    icon: 'fa-solid fa-envelope' // Icono de sobre
                },
                {
                    title: 'AUTOMATIZACIÓN',
                    subtitle: 'FLUJOS EFECTIVOS',  // Cambiado de "SECUENCIAS" a "FLUJOS"
                    description: 'Flujos para cada etapa del embudo',
                    bgColor: colors.dark,
                    accentColor: colors.email,
                    icon: 'fa-solid fa-robot' // Icono de robot
                },
                {
                    title: 'SEGMENTACIÓN',
                    subtitle: 'MENSAJES CLAVE',  // Acortado de "MENSAJES RELEVANTES"
                    description: 'Emails personalizados por comportamiento',
                    bgColor: colors.dark,
                    accentColor: colors.email,
                    icon: 'fa-solid fa-users-viewfinder' // Icono de segmentación
                },
                {
                    title: 'ANÁLISIS COMPLETO',
                    subtitle: 'MÉTRICAS CLAVE',  // Acortado de "MÉTRICAS QUE IMPULSAN"
                    description: 'Reportes detallados de resultados',
                    bgColor: colors.dark,
                    accentColor: colors.email,
                    icon: 'fa-solid fa-chart-column' // Icono de gráfico de columnas
                }
            ],
            chatbot: [
                {
                    title: 'CHATBOT IA',  // Acortado de "CHATBOT INTELIGENTE"
                    subtitle: 'SERVICIO 24/7',
                    description: 'Atención automatizada que convierte',
                    bgColor: colors.chatbot,
                    icon: 'fa-solid fa-message' // Icono de mensaje
                },
                {
                    title: 'DIÁLOGOS FLUIDOS',  // Cambiado de "CONVERSACIONES FLUIDAS"
                    subtitle: 'IA AVANZADA',  // Acortado de "RESPUESTAS INTELIGENTES"
                    description: 'IA que entiende preguntas complejas',
                    bgColor: colors.dark,
                    accentColor: colors.chatbot,
                    icon: 'fa-solid fa-comments' // Icono de conversación
                },
                {
                    title: 'INTEGRACIÓN TOTAL',  // Cambiado de "COMPLETA" a "TOTAL"
                    subtitle: 'MULTICANAL',  // Acortado de "ADAPTADO A TU NEGOCIO"
                    description: 'Conectado con todos tus canales',
                    bgColor: colors.dark,
                    accentColor: colors.chatbot,
                    icon: 'fa-solid fa-code-branch' // Icono de integración
                },
                {
                    title: 'RESULTADOS REALES',  // Cambiado de "CONCRETOS" a "REALES"
                    subtitle: 'MÁS CONVERSIÓN',  // Acortado de "AUMENTO DE CONVERSIÓN"
                    description: 'Captura leads cuando más interesa',
                    bgColor: colors.dark,
                    accentColor: colors.chatbot,
                    icon: 'fa-solid fa-check-double' // Icono de doble check
                }
            ],
            all: [
                {
                    title: 'PAQUETE COMPLETO',
                    subtitle: '4 SERVICIOS',  // Acortado de "4 SERVICIOS INTEGRADOS"
                    description: 'Solución integral por US$1000/mes',
                    bgColor: '#333333',
                    icon: 'fa-solid fa-crown' // Icono de corona
                },
                {
                    title: 'ESTRATEGIA 360°',
                    subtitle: 'DIGITAL TOTAL',  // Acortado de "PRESENCIA DIGITAL TOTAL"
                    description: 'Tráfico, conversión y fidelización',
                    bgColor: colors.dark,
                    accentColor: colors.primary,
                    icon: 'fa-solid fa-compass' // Icono de brújula
                },
                {
                    title: 'AHORRO SUPERIOR',  // Cambiado de "SIGNIFICATIVO" a "SUPERIOR"
                    subtitle: 'DESCUENTO',  // Acortado de "DESCUENTO ESPECIAL"
                    description: 'Ahorrás US$200 mensuales',
                    bgColor: colors.dark,
                    accentColor: colors.primary,
                    icon: 'fa-solid fa-piggy-bank' // Icono de ahorro
                },
                {
                    title: 'SINERGIA',  // Acortado de "RESULTADOS AMPLIFICADOS"
                    subtitle: 'MAYOR IMPACTO',  // Cambiado de "EL PODER DE LA SINERGIA"
                    description: 'Cada canal potencia a los demás',
                    bgColor: colors.dark,
                    accentColor: colors.primary,
                    icon: 'fa-solid fa-handshake' // Icono de sinergia
                }
            ]
        };

        let activeService = 'optimizacion';
        let activeFormat = 'square';
        let selectedCreativeIndex = null;
        
        // Elementos DOM
        const serviceTitle = document.getElementById('serviceTitle');
        const creativesContainer = document.getElementById('creativesContainer');
        const tabButtons = document.querySelectorAll('.tab-button');
        const formatButtons = document.querySelectorAll('.format-btn');
        const squareBtn = document.getElementById('squareBtn');
        const verticalBtn = document.getElementById('verticalBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const togglePracticesBtn = document.getElementById('togglePractices');
        const bestPracticesBox = document.querySelector('.best-practices');
        const exportCanvas = document.getElementById('exportCanvas');
        const fullSizeViewer = document.getElementById('fullSizeViewer');
        const fullSizeOverlay = document.getElementById('fullSizeOverlay');
        const closeViewer = document.getElementById('closeViewer');
        const downloadImage = document.getElementById('downloadImage');
        const statusDiv = document.getElementById('status');

        // Verificar si html2canvas está cargado
        if (typeof html2canvas === 'undefined') {
            showStatus('Error: No se pudo cargar html2canvas. Por favor, verifica tu conexión a internet.', true);
        }
        
        // Toggle para mejores prácticas
        togglePracticesBtn.addEventListener('click', () => {
            if (bestPracticesBox.style.display === 'none') {
                bestPracticesBox.style.display = 'block';
                togglePracticesBtn.textContent = 'Ocultar mejores prácticas';
            } else {
                bestPracticesBox.style.display = 'none';
                togglePracticesBtn.textContent = 'Ver mejores prácticas aplicadas';
            }
        });

        // Mostrar mensajes de estado
        function showStatus(message, isError = false) {
            statusDiv.textContent = message;
            statusDiv.style.display = 'block';
            
            if (isError) {
                statusDiv.style.backgroundColor = '#f8d7da';
                statusDiv.style.color = '#721c24';
            } else {
                statusDiv.style.backgroundColor = '#d4edda';
                statusDiv.style.color = '#155724';
            }
            
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 5000);
        }
        
        // Función para obtener título según el servicio
        function getServiceTitle(service) {
            switch (service) {
                case 'optimizacion': return 'Creativos para Optimización Express';
                case 'meta': return 'Creativos para Meta Ads';
                case 'google': return 'Creativos para Google Ads';
                case 'email': return 'Creativos para Email Marketing';
                case 'chatbot': return 'Creativos para Chatbot';
                case 'all': return 'Creativos para Paquete Completo';
                default: return 'Creativos para Optimización Express';
            }
        }
        
        // Función para obtener el color de contraste para el logo según el fondo
        function getLogoBackgroundColor(bgColor) {
            // Si el fondo es oscuro, usar un fondo claro y viceversa
            if (bgColor === colors.dark || bgColor === '#333333') {
                return 'rgba(255, 255, 255, 0.2)'; // Fondo claro semi-transparente
            } else {
                return 'rgba(0, 0, 0, 0.2)'; // Fondo oscuro semi-transparente
            }
        }
        
        // Función para renderizar creativos
        function renderCreatives() {
            creativesContainer.innerHTML = '';
            const creatives = creativesData[activeService];
            
            creatives.forEach((creative, index) => {
                const isFirst = index === 0;
                
                // Crear elemento creativo
                const creativeEl = document.createElement('div');
                creativeEl.className = `creative ${activeFormat === 'vertical' ? 'creative-vertical' : ''}`;
                creativeEl.dataset.index = index;
                creativeEl.style.backgroundColor = creative.bgColor;
                
                // Barra lateral (acento)
                const accentEl = document.createElement('div');
                accentEl.className = 'creative-accent';
                accentEl.style.background = isFirst ? colors.light : (creative.accentColor || colors.primary);
                creativeEl.appendChild(accentEl);
                
                // Contenido
                const contentEl = document.createElement('div');
                contentEl.className = 'creative-content';
                
                // Contenedor del logo con fondo para mejor contraste
                const logoContainerEl = document.createElement('div');
                logoContainerEl.className = 'logo-container';
                logoContainerEl.style.backgroundColor = getLogoBackgroundColor(creative.bgColor);
                
                // Logo
                const logoEl = document.createElement('div');
                logoEl.style.fontWeight = 'bold';
                logoEl.style.fontSize = '14px';
                
                if (isFirst) {
                    logoEl.innerHTML = 'Orange <span style="color: #FF7E00;">Vapor</span>';
                } else {
                    // OV con O en blanco y V en naranja
                    logoEl.innerHTML = '<span style="color: white;">O</span><span style="color: #FF7E00;">V</span>';
                }
                logoContainerEl.appendChild(logoEl);
                contentEl.appendChild(logoContainerEl);
                
                // Título
                const titleEl = document.createElement('div');
                titleEl.className = 'creative-title';
                titleEl.textContent = creative.title;
                if (!isFirst && creative.accentColor) {
                    titleEl.style.color = creative.accentColor;
                }
                contentEl.appendChild(titleEl);
                
                // Subtítulo
                const subtitleEl = document.createElement('div');
                subtitleEl.className = 'creative-subtitle';
                subtitleEl.textContent = creative.subtitle;
                contentEl.appendChild(subtitleEl);
                
                // Descripción
                const descEl = document.createElement('div');
                descEl.className = 'creative-description';
                descEl.textContent = creative.description;
                contentEl.appendChild(descEl);
                
                // Icono específico del servicio (nuevo)
                if (creative.icon) {
                    const iconEl = document.createElement('div');
                    iconEl.style.position = 'absolute';
                    iconEl.style.bottom = '15px';
                    iconEl.style.left = '15px';
                    iconEl.style.fontSize = '18px';
                    iconEl.style.opacity = '0.7';
                    iconEl.innerHTML = `<i class="${creative.icon}"></i>`;
                    contentEl.appendChild(iconEl);
                }
                
                creativeEl.appendChild(contentEl);
                
                // Número
                const numberEl = document.createElement('div');
                numberEl.className = 'creative-number';
                numberEl.textContent = `${index + 1}/4`;
                creativeEl.appendChild(numberEl);
                
                // Botón de descarga
                const downloadEl = document.createElement('div');
                downloadEl.className = 'creative-download';
                downloadEl.innerHTML = '<i class="fas fa-download"></i>';
                downloadEl.addEventListener('click', (e) => {
                    e.stopPropagation(); // Evitar que se propague el evento
                    selectedCreativeIndex = index;
                    openFullSizeViewer(index);
                });
                creativeEl.appendChild(downloadEl);
                
                // Mostrar previsualización del creativo
                creativeEl.addEventListener('click', () => {
                    selectedCreativeIndex = index;
                    openFullSizeViewer(index);
                });
                
                creativesContainer.appendChild(creativeEl);
            });
        }

        // Abrir visualizador tamaño completo
        function openFullSizeViewer(index) {
            fullSizeViewer.innerHTML = '';
            fullSizeViewer.className = activeFormat === 'vertical' ? 'fullsize-vertical' : 'fullsize-square';
            
            // Recrear el creativo en tamaño completo
            const clonedCreative = createClonedCreative(index);
            fullSizeViewer.appendChild(clonedCreative);
            
            // Agregar botones
            const closeBtn = document.createElement('button');
            closeBtn.id = 'closeViewer';
            closeBtn.innerHTML = '<i class="fas fa-times"></i>';
            closeBtn.addEventListener('click', closeFullSizeViewer);
            
            const downloadBtn = document.createElement('button');
            downloadBtn.id = 'downloadImage';
            downloadBtn.innerHTML = '<i class="fas fa-download"></i> Descargar';
            downloadBtn.addEventListener('click', () => {
                captureAndDownload(index);
            });
            
            fullSizeViewer.appendChild(closeBtn);
            fullSizeViewer.appendChild(downloadBtn);
            
            fullSizeOverlay.style.display = 'block';
            fullSizeViewer.style.display = 'block';
        }

        // Cerrar visualizador tamaño completo
        function closeFullSizeViewer() {
            fullSizeOverlay.style.display = 'none';
            fullSizeViewer.style.display = 'none';
        }

        // Crear un clon del creativo para visualización completa
        function createClonedCreative(index) {
            const creative = creativesData[activeService][index];
            const isFirst = index === 0;
            
            // Crear elemento creativo
            const creativeEl = document.createElement('div');
            creativeEl.className = `creative`;
            creativeEl.style.width = '100%';
            creativeEl.style.height = '100%';
            creativeEl.style.margin = '0';
            creativeEl.style.backgroundColor = creative.bgColor;
            
            // Barra lateral (acento)
            const accentEl = document.createElement('div');
            accentEl.className = 'creative-accent';
            accentEl.style.background = isFirst ? colors.light : (creative.accentColor || colors.primary);
            creativeEl.appendChild(accentEl);
            
            // Contenido
            const contentEl = document.createElement('div');
            contentEl.className = 'creative-content';
            
            // Contenedor del logo con fondo para mejor contraste
            const logoContainerEl = document.createElement('div');
            logoContainerEl.className = 'logo-container';
            logoContainerEl.style.backgroundColor = getLogoBackgroundColor(creative.bgColor);
            
            // Logo
            const logoEl = document.createElement('div');
            logoEl.style.fontWeight = 'bold';
            logoEl.style.fontSize = activeFormat === 'vertical' ? '18px' : '22px';
            
            if (isFirst) {
                logoEl.innerHTML = 'Orange <span style="color: #FF7E00;">Vapor</span>';
            } else {
                // OV con O en blanco y V en naranja
                logoEl.innerHTML = '<span style="color: white;">O</span><span style="color: #FF7E00;">V</span>';
            }
            logoContainerEl.appendChild(logoEl);
            contentEl.appendChild(logoContainerEl);
            
            // Título
            const titleEl = document.createElement('div');
            titleEl.className = 'creative-title';
            titleEl.style.fontSize = activeFormat === 'vertical' ? '30px' : '40px';
            titleEl.textContent = creative.title;
            if (!isFirst && creative.accentColor) {
                titleEl.style.color = creative.accentColor;
            }
            contentEl.appendChild(titleEl);
            
            // Subtítulo
            const subtitleEl = document.createElement('div');
            subtitleEl.className = 'creative-subtitle';
            subtitleEl.style.fontSize = activeFormat === 'vertical' ? '20px' : '24px';
            subtitleEl.textContent = creative.subtitle;
            contentEl.appendChild(subtitleEl);
            
            // Descripción
            const descEl = document.createElement('div');
            descEl.className = 'creative-description';
            descEl.style.fontSize = activeFormat === 'vertical' ? '18px' : '20px';
            descEl.textContent = creative.description;
            contentEl.appendChild(descEl);
            
            // Icono específico del servicio (nuevo)
            if (creative.icon) {
                const iconEl = document.createElement('div');
                iconEl.style.position = 'absolute';
                iconEl.style.bottom = '15px';
                iconEl.style.left = '15px';
                iconEl.style.fontSize = activeFormat === 'vertical' ? '22px' : '26px';
                iconEl.style.opacity = '0.7';
                iconEl.innerHTML = `<i class="${creative.icon}"></i>`;
                contentEl.appendChild(iconEl);
            }
            
            creativeEl.appendChild(contentEl);
            
            // Número
            const numberEl = document.createElement('div');
            numberEl.className = 'creative-number';
            numberEl.style.width = activeFormat === 'vertical' ? '40px' : '50px';
            numberEl.style.height = activeFormat === 'vertical' ? '40px' : '50px';
            numberEl.style.fontSize = activeFormat === 'vertical' ? '16px' : '18px';
            numberEl.textContent = `${index + 1}/4`;
            creativeEl.appendChild(numberEl);
            
            return creativeEl;
        }

        // Capturar creativo y descargarlo
        function captureAndDownload(index) {
            try {
                showStatus('Generando imagen en alta resolución...');
                
                const creativeElements = document.querySelectorAll('.creative');
                const creative = creativeElements[index];
                
                if (!creative) {
                    showStatus('Error: No se pudo encontrar el creativo.', true);
                    return;
                }
                
                // Usar método de screenshot simple con canvas directo
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                // Definir tamaño según formato
                if (activeFormat === 'vertical') {
                    canvas.width = 1080;
                    canvas.height = 1920;
                } else {
                    canvas.width = 1080;
                    canvas.height = 1080;
                }
                
                // Dibujar creativo
                drawCreativeDirectly(ctx, index);
                
                // Descargar imagen
                downloadCanvasAsImage(canvas, index);
                
            } catch (error) {
                console.error('Error al capturar creativo:', error);
                showStatus('Error al capturar la imagen. ' + error.message, true);
                
                // Método alternativo
                try {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    
                    // Definir tamaño según formato
                    if (activeFormat === 'vertical') {
                        canvas.width = 1080;
                        canvas.height = 1920;
                    } else {
                        canvas.width = 1080;
                        canvas.height = 1080;
                    }
                    
                    // Dibujar fondo
                    const creative = creativesData[activeService][index];
                    ctx.fillStyle = creative.bgColor;
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // Dibujar texto
                    ctx.fillStyle = '#FFFFFF';
                    ctx.font = '48px Montserrat, sans-serif';
                    ctx.textAlign = 'center';
                    ctx.fillText(creative.title, canvas.width/2, canvas.height/2 - 50);
                    ctx.fillText(creative.subtitle, canvas.width/2, canvas.height/2 + 50);
                    
                    // Descargar imagen
                    downloadCanvasAsImage(canvas, index);
                    
                } catch (fallbackError) {
                    console.error('Error en método alternativo:', fallbackError);
                    showStatus('No se pudo generar la imagen. Por favor intenta de nuevo.', true);
                }
            }
        }

        // Dibujar creativo directamente
        function drawCreativeDirectly(ctx, index) {
            const creative = creativesData[activeService][index];
            const isFirst = index === 0;
            const isVertical = activeFormat === 'vertical';
            const width = ctx.canvas.width;
            const height = ctx.canvas.height;
            
            // 1. Dibujar fondo
            ctx.fillStyle = creative.bgColor;
            ctx.fillRect(0, 0, width, height);
            
            // 2. Dibujar barra lateral (acento)
            ctx.fillStyle = isFirst ? colors.light : (creative.accentColor || colors.primary);
            
            if (isVertical) {
                // Calcular zonas seguras (14% superior e inferior)
                const safeZoneTop = Math.round(height * 0.14);
                const accentY = safeZoneTop + 100;
                const accentHeight = height - accentY - safeZoneTop - 100;
                
                ctx.beginPath();
                ctx.moveTo(0, accentY);
                ctx.lineTo(0, accentY + accentHeight);
                ctx.lineTo(16, accentY + accentHeight);
                ctx.arcTo(20, accentY + accentHeight, 20, accentY + accentHeight - 5, 5);
                ctx.lineTo(20, accentY + 5);
                ctx.arcTo(20, accentY, 16, accentY, 5);
                ctx.lineTo(0, accentY);
                ctx.fill();
            } else {
                ctx.beginPath();
                ctx.moveTo(0, height * 0.3);
                ctx.lineTo(0, height * 0.3 + height * 0.3);
                ctx.lineTo(12, height * 0.3 + height * 0.3);
                ctx.arcTo(15, height * 0.3 + height * 0.3, 15, height * 0.3 + height * 0.3 - 3, 3);
                ctx.lineTo(15, height * 0.3 + 3);
                ctx.arcTo(15, height * 0.3, 12, height * 0.3, 3);
                ctx.lineTo(0, height * 0.3);
                ctx.fill();
            }
            
            // 3. Dibujar logo
            // Fondo del logo
            const logoBackgroundColor = getLogoBackgroundColor(creative.bgColor);
            ctx.fillStyle = logoBackgroundColor;
            
            if (isVertical) {
                const safeZoneTop = Math.round(height * 0.14);
                roundRect(ctx, 30, safeZoneTop + 10, 200, 50, 4);
            } else {
                roundRect(ctx, 30, 20, 200, 50, 4);
            }
            ctx.fill();
            
            // Logo texto
            if (isVertical) {
                const safeZoneTop = Math.round(height * 0.14);
                const logoY = safeZoneTop + 50;
                ctx.font = 'bold 42px Montserrat, sans-serif';
                
                if (isFirst) {
                    ctx.fillStyle = colors.light;
                    ctx.fillText('Orange', 40, logoY);
                    ctx.fillStyle = '#FF7E00';
                    const orangeWidth = ctx.measureText('Orange ').width;
                    ctx.fillText('Vapor', 40 + orangeWidth, logoY);
                } else {
                    ctx.fillStyle = colors.light;
                    ctx.fillText('O', 40, logoY);
                    ctx.fillStyle = '#FF7E00';
                    const oWidth = ctx.measureText('O').width;
                    ctx.fillText('V', 40 + oWidth, logoY);
                }
            } else {
                ctx.font = 'bold 36px Montserrat, sans-serif';
                
                if (isFirst) {
                    ctx.fillStyle = colors.light;
                    ctx.fillText('Orange', 40, 60);
                    ctx.fillStyle = '#FF7E00';
                    const orangeWidth = ctx.measureText('Orange ').width;
                    ctx.fillText('Vapor', 40 + orangeWidth, 60);
                } else {
                    ctx.fillStyle = colors.light;
                    ctx.fillText('O', 40, 60);
                    ctx.fillStyle = '#FF7E00';
                    const oWidth = ctx.measureText('O').width;
                    ctx.fillText('V', 40 + oWidth, 60);
                }
            }
            
            // 4. Dibujar contenido centrado
            const centerX = width / 2;
            let centerY = height / 2;
            
            // Título
            ctx.textAlign = 'center';
            
            if (isVertical) {
                ctx.font = 'bold 80px Montserrat, sans-serif';
                if (!isFirst && creative.accentColor) {
                    ctx.fillStyle = creative.accentColor;
                } else {
                    ctx.fillStyle = colors.light;
                }
                const titleY = centerY - 200;
                wrapTextCentered(ctx, creative.title, centerX, titleY, width - 300, 90);
            } else {
                ctx.font = 'bold 70px Montserrat, sans-serif';
                if (!isFirst && creative.accentColor) {
                    ctx.fillStyle = creative.accentColor;
                } else {
                    ctx.fillStyle = colors.light;
                }
                const titleY = centerY - 80;
                wrapTextCentered(ctx, creative.title, centerX, titleY, width - 250, 80);
            }
            
            // Subtítulo con fondo
            ctx.fillStyle = 'rgba(0,0,0,0.25)';
            
            if (isVertical) {
                ctx.font = 'bold 56px Montserrat, sans-serif';
                const subtitleMetrics = ctx.measureText(creative.subtitle);
                const subtitleWidth = Math.min(subtitleMetrics.width + 100, width - 300);
                const subtitleY = centerY;
                
                roundRect(ctx, centerX - subtitleWidth/2, subtitleY - 50, subtitleWidth, 100, 4);
                ctx.fill();
                
                ctx.fillStyle = colors.light;
                ctx.font = 'bold 56px Montserrat, sans-serif';
                ctx.fillText(creative.subtitle, centerX, subtitleY + 20);
            } else {
                ctx.font = 'bold 46px Montserrat, sans-serif';
                const subtitleMetrics = ctx.measureText(creative.subtitle);
                const subtitleWidth = Math.min(subtitleMetrics.width + 80, width - 200);
                const subtitleY = centerY + 30;
                
                roundRect(ctx, centerX - subtitleWidth/2, subtitleY - 40, subtitleWidth, 80, 4);
                ctx.fill();
                
                ctx.fillStyle = colors.light;
                ctx.font = 'bold 46px Montserrat, sans-serif';
                ctx.fillText(creative.subtitle, centerX, subtitleY + 20);
            }
            
            // Descripción
            ctx.fillStyle = 'rgba(255,255,255,0.95)';
            
            if (isVertical) {
                ctx.font = '42px Montserrat, sans-serif';
                const descY = centerY + 150;
                wrapTextCentered(ctx, creative.description, centerX, descY, width - 300, 60);
            } else {
                ctx.font = '36px Montserrat, sans-serif';
                const descY = centerY + 150;
                wrapTextCentered(ctx, creative.description, centerX, descY, width - 250, 50);
            }
            
            // 5. Dibujar número
            ctx.fillStyle = 'rgba(255,255,255,0.2)';
            
            if (isVertical) {
                const safeZoneBottom = height - Math.round(height * 0.14);
                ctx.beginPath();
                ctx.arc(width - 80, safeZoneBottom - 80, 40, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = colors.light;
                ctx.font = 'bold 30px Montserrat, sans-serif';
                ctx.fillText(`${index + 1}/4`, width - 80, safeZoneBottom - 70);
            } else {
                ctx.beginPath();
                ctx.arc(width - 70, height - 70, 30, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = colors.light;
                ctx.font = 'bold 24px Montserrat, sans-serif';
                ctx.fillText(`${index + 1}/4`, width - 70, height - 62);
            }
        }

        // Función para dibujar rectángulos con esquinas redondeadas
        function roundRect(ctx, x, y, width, height, radius) {
            if (width < 2 * radius) radius = width / 2;
            if (height < 2 * radius) radius = height / 2;
            ctx.beginPath();
            ctx.moveTo(x + radius, y);
            ctx.arcTo(x + width, y, x + width, y + height, radius);
            ctx.arcTo(x + width, y + height, x, y + height, radius);
            ctx.arcTo(x, y + height, x, y, radius);
            ctx.arcTo(x, y, x + width, y, radius);
            ctx.closePath();
            return ctx;
        }
        
        // Función para envolver texto centrado
        function wrapTextCentered(ctx, text, x, y, maxWidth, lineHeight) {
            const words = text.split(' ');
            let line = '';
            let lineY = y;
            
            for (let i = 0; i < words.length; i++) {
                const testLine = line + words[i] + ' ';
                const metrics = ctx.measureText(testLine);
                const testWidth = metrics.width;
                
                if (testWidth > maxWidth && i > 0) {
                    ctx.fillText(line, x, lineY);
                    line = words[i] + ' ';
                    lineY += lineHeight;
                } else {
                    line = testLine;
                }
            }
            
            ctx.fillText(line, x, lineY);
            return lineY;
        }

        // Descargar canvas como imagen
        function downloadCanvasAsImage(canvas, index) {
            try {
                const imageURL = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.href = imageURL;
                link.download = `${activeService}-${activeFormat === 'vertical' ? 'vertical' : 'cuadrado'}-${index + 1}.png`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showStatus('¡Imagen descargada con éxito!');
                setTimeout(() => {
                    closeFullSizeViewer();
                }, 1000);
            } catch (error) {
                console.error('Error al descargar imagen:', error);
                showStatus('Error al descargar la imagen. ' + error.message, true);
            }
        }

        // Descargar todos los creativos
        function downloadAllCreatives() {
            showStatus('Preparando descarga de todos los creativos...');
            
            // Descargar creativos uno por uno con pequeño retraso
            for (let i = 0; i < 4; i++) {
                setTimeout(() => {
                    try {
                        // Crear canvas
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        
                        // Configurar tamaño
                        if (activeFormat === 'vertical') {
                            canvas.width = 1080;
                            canvas.height = 1920;
                        } else {
                            canvas.width = 1080;
                            canvas.height = 1080;
                        }
                        
                        // Dibujar creativo
                        drawCreativeDirectly(ctx, i);
                        
                        // Descargar
                        const imageURL = canvas.toDataURL('image/png');
                        const link = document.createElement('a');
                        link.href = imageURL;
                        link.download = `${activeService}-${activeFormat === 'vertical' ? 'vertical' : 'cuadrado'}-${i + 1}.png`;
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        
                        if (i === 3) {
                            showStatus('Todos los creativos descargados con éxito.');
                        }
                    } catch (error) {
                        console.error(`Error al descargar creativo ${i+1}:`, error);
                        showStatus(`Error al descargar creativo ${i+1}. ` + error.message, true);
                    }
                }, i * 1000); // 1 segundo entre descargas
            }
        }
        
        // Función para actualizar UI
        function updateUI() {
            serviceTitle.textContent = getServiceTitle(activeService);
            
            tabButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.service === activeService) {
                    btn.classList.add('active');
                }
            });
            
            formatButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (activeFormat === 'square') {
                squareBtn.classList.add('active');
            } else {
                verticalBtn.classList.add('active');
            }
            
            renderCreatives();
        }
        
        // Eventos
        tabButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                activeService = btn.dataset.service;
                updateUI();
            });
        });
        
        squareBtn.addEventListener('click', () => {
            activeFormat = 'square';
            updateUI();
        });
        
        verticalBtn.addEventListener('click', () => {
            activeFormat = 'vertical';
            updateUI();
        });
        
        downloadBtn.addEventListener('click', downloadAllCreatives);
        
        fullSizeOverlay.addEventListener('click', closeFullSizeViewer);
        
        // Verificar que Canvas esté disponible
        try {
            const testCanvas = document.createElement('canvas');
            const testCtx = testCanvas.getContext('2d');
            testCtx.fillStyle = 'red';
            testCtx.fillRect(0, 0, 10, 10);
            testCanvas.toDataURL(); // Verificar que se puede convertir a imagen
        } catch (error) {
            console.error('Error al verificar disponibilidad de Canvas:', error);
            showStatus('Error: Tu navegador no soporta la función de canvas necesaria para generar imágenes. Prueba con otro navegador como Chrome o Firefox.', true);
        }
        
        // Inicializar
        updateUI();
    </script>
</body>
</html>
