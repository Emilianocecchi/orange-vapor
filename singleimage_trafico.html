<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creativos Orange Vapor - Campa√±as de Ads Optimizadas</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            font-size: 28px;
            color: #2c2c2c;
            margin-bottom: 10px;
        }
        .header p {
            color: #666;
            font-size: 16px;
        }
        .tabs {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        .tab-group {
            display: inline-flex;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
        }
        .tab-button {
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 500;
            background-color: white;
            color: #333;
            border: 1px solid #ddd;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .tab-button:first-child {
            border-top-left-radius: 6px;
            border-bottom-left-radius: 6px;
        }
        .tab-button:last-child {
            border-top-right-radius: 6px;
            border-bottom-right-radius: 6px;
        }
        .tab-button.active {
            color: white;
        }
        .tab-button.optimizacion.active { background: linear-gradient(135deg, #dc3545 0%, #ad1f2d 100%); border-color: #ad1f2d; }
        .tab-button.meta.active { background: linear-gradient(135deg, #1877F2 0%, #0e4693 100%); border-color: #0e4693; }
        .tab-button.google.active { background: linear-gradient(135deg, #4285F4 0%, #2a61c5 100%); border-color: #2a61c5; }
        .tab-button.email.active { background: linear-gradient(135deg, #00829b 0%, #00546a 100%); border-color: #00546a; }
        .tab-button.chatbot.active { background: linear-gradient(135deg, #6f42c1 0%, #502e8c 100%); border-color: #502e8c; }
        .tab-button.all.active { background: linear-gradient(135deg, #333333 0%, #222222 100%); border-color: #222222; }
        .tab-button.auditoria.active { background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%); border-color: #1e7e34; }

        /* Selector de color */
        .color-toggle { text-align: center; margin: 20px 0; }
        .color-btn {
            width: 36px; height: 36px; border-radius: 50%; margin: 0 5px;
            cursor: pointer; display: inline-block; border: 2px solid #ddd;
            transition: all 0.2s ease; overflow: hidden;
        }
        .color-btn.active { border-color: #ff7e00; transform: scale(1.1); }
        .color-btn-original { background: linear-gradient(135deg, #28a745 14%, #dc3545 14% 28%, #1877F2 28% 42%, #4285F4 42% 56%, #00829b 56% 70%, #6f42c1 70% 84%, #333 84%); }
        .color-btn-orange { background-color: #ff7e00; }
        .color-btn-white { background-color: #ffffff; border: 2px solid #ccc; }
        .color-btn-black { background-color: #181818; }
        
        /* Selector de plataforma */
        .platform-toggle {
            text-align: center;
            margin: 20px 0;
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .platform-btn {
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 500;
            background-color: white;
            color: #333;
            border: 1px solid #ddd;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .platform-btn.active {
            background-color: #ff7e00;
            color: white;
            border-color: #ff7e00;
        }
        .platform-btn i {
            font-size: 16px;
        }

        /* Secci√≥n de descarga */
        .download-section { text-align: center; margin: 20px 0; }
        .download-btn {
            background: linear-gradient(135deg, #ff7e00 0%, #e67300 100%);
            color: white; border: none; padding: 12px 24px;
            font-size: 16px; font-weight: bold; border-radius: 6px; cursor: pointer;
            display: inline-flex; align-items: center; gap: 10px;
            box-shadow: 0 4px 8px rgba(255, 126, 0, 0.3); transition: all 0.3s ease;
        }
        .download-btn:hover { background: linear-gradient(135deg, #e67300 0%, #cc6600 100%); transform: translateY(-2px); }

        /* Contenedor de creativos */
        .creatives-container { display: flex; flex-wrap: wrap; justify-content: center; margin-top: 20px; }
        .creative {
            width: 360px; height: 360px; margin: 10px; position: relative;
            border-radius: 8px; overflow: hidden; 
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.15);
            color: white; cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .creative:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }
        .creative-vertical { width: 240px; height: 427px; }
        .creative-content {
            position: relative; z-index: 2; padding: 20px; height: 100%;
            display: flex; flex-direction: column; justify-content: center; text-align: center;
        }
        .creative-title { 
            font-size: 22px; font-weight: bold; margin-bottom: 10px; line-height: 1.2; 
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        .creative-subtitle { 
            font-size: 18px; font-weight: bold; margin-bottom: 10px; line-height: 1.2;
            text-shadow: 0 1px 1px rgba(0, 0, 0, 0.15);
        }
        .creative-description { 
            font-size: 14px; line-height: 1.4; 
            margin-bottom: 15px;
        }
        .creative-description .highlight {
            background: rgba(255, 255, 255, 0.2);
            padding: 0 5px;
            border-radius: 3px;
            font-weight: bold;
        }
        .creative-accent {
            position: absolute; left: 0; top: 30%; width: 6px; height: 100px;
            background: white; border-radius: 0 3px 3px 0; z-index: 1;
        }

        /* CTA Button */
        .cta-button {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 30px;
            padding: 8px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-weight: bold;
            font-size: 14px;
            margin: 10px auto;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            transition: all 0.2s ease;
            color: #333;
        }
        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }
        .cta-button .arrow-icon {
            transition: transform 0.2s ease;
        }
        .cta-button:hover .arrow-icon {
            transform: translateX(3px);
        }
        
        /* Friction reducer text */
        .friction-reducer {
            font-size: 11px;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        /* Service Icon */
        .service-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 22px;
        }
        
        /* Proof Badge */
        .proof-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 5px;
            padding: 5px 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            z-index: 3;
        }
        .proof-number {
            font-weight: bold;
            font-size: 14px;
            color: #ff7e00;
        }
        .proof-text {
            font-size: 10px;
            color: #333;
        }
        
        /* Guarantee Badge */
        .guarantee-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            margin-top: 10px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 5px 10px;
            font-size: 12px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Limited Spots */
        .limited-spots {
            background: rgba(255, 0, 0, 0.1);
            border-left: 3px solid rgba(255, 0, 0, 0.5);
            padding: 5px 10px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Mini Testimonial */
        .mini-testimonial {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 12px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
        }
        .mini-testimonial .stars {
            color: #FFD700;
            margin-bottom: 3px;
            letter-spacing: -1px;
        }
        .mini-testimonial .quote {
            font-style: italic;
        }
        
        /* Creative Download Button */
        .creative-download {
            position: absolute; top: 10px; right: 10px; width: 30px; height: 30px;
            border-radius: 50%; background: rgba(68, 68, 68, 0.8); display: flex;
            align-items: center; justify-content: center; cursor: pointer;
            opacity: 0; transition: opacity 0.3s; z-index: 10;
        }
        .creative:hover .creative-download { opacity: 1; }

        /* Estilo para el Ribbon */
        .creative-ribbon {
            position: absolute; background: linear-gradient(135deg, #FFD700, #FFC107);
            color: #333; padding: 5px 8px; font-size: 12px; font-weight: bold; z-index: 3;
            top: 15px; right: -35px; width: 130px; text-align: center;
            transform: rotate(45deg); box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            text-transform: uppercase;
        }
        .creative-vertical .creative-ribbon { font-size: 13px; top: 20px; right: -40px; width: 150px; }

        /* Notas y cajas informativas */
        .note { text-align: center; margin-top: 30px; color: #666; font-size: 12px; }
        .info-box {
            background-color: #e6f7ff; border-left: 4px solid #1890ff; padding: 15px;
            margin: 20px auto; max-width: 800px; border-radius: 4px; display: flex;
            align-items: flex-start;
        }
        .info-box i { color: #1890ff; font-size: 20px; margin-right: 10px; margin-top: 2px; }
        .info-box p { color: #333; font-size: 14px; margin: 0; line-height: 1.5; }

        /* Toggle de formato */
        .format-toggle { text-align: center; margin: 20px 0; }
        .format-btn {
            padding: 8px 16px; border: 1px solid #ddd; border-radius: 4px;
            background-color: white; margin: 0 5px; cursor: pointer; transition: all 0.2s ease;
        }
        .format-btn.active { background: linear-gradient(135deg, #ff7e00 0%, #e67300 100%); color: white; border-color: #e67300; }

        /* Mejores pr√°cticas */
        .best-practices { background-color: #f8f8f8; border-radius: 8px; padding: 15px; margin: 20px 0; }
        .best-practices h3 { font-size: 16px; color: #333; margin-bottom: 10px; }
        .best-practices ul { list-style-type: disc; margin-left: 20px; }
        .best-practices li { font-size: 13px; margin-bottom: 5px; color: #666; }
        .toggle-practices {
            display: block; margin: 10px auto; background: none; border: 1px solid #ddd;
            padding: 5px 10px; font-size: 12px; color: #666; cursor: pointer; border-radius: 4px;
        }

        /* Logo */
        .logo-container {
            position: absolute; top: 10px; left: 10px; padding: 5px 10px;
            border-radius: 4px; z-index: 2; text-align: left;
        }

        /* Modal de carga */
        .loading-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.7); display: flex; justify-content: center;
            align-items: center; z-index: 9999;
        }
        .loading-container {
            background-color: #fff; padding: 20px 30px; border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3); text-align: center;
        }
        .loading-spinner {
            display: inline-block; width: 30px; height: 30px; border: 4px solid rgba(0,0,0,.1);
            border-radius: 50%; border-top-color: #ff7e00;
            animation: spin 1s ease-in-out infinite; margin-bottom: 10px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Canvas oculto */
        #downloadCanvas { position: absolute; left: -9999px; top: -9999px; }

        /* Indicador 20% texto */
        .text-20-indicator {
            padding: 8px 12px; font-size: 13px; background-color: rgba(255, 126, 0, 0.1);
            border: 1px solid #ff7e00; color: #666; margin: 10px 0;
            border-radius: 4px; text-align: center;
        }
        .text-20-indicator i { color: #00b300; margin-right: 5px; }

        /* Secci√≥n Ad Copy */
        .ad-copy-section { margin-top: 40px; border-top: 1px solid #eee; padding-top: 20px; }
        .ad-copy-section h3 { font-size: 18px; color: #333; text-align: center; margin-bottom: 15px; }
        .ad-copy-container {
            background-color: #f9f9f9; border: 1px solid #e0e0e0; border-radius: 8px;
            padding: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            max-width: 800px; margin: 0 auto;
        }
        .ad-copy-text { font-size: 16px; line-height: 1.6; color: #444; white-space: pre-line; }
        .copy-btn {
            background: #f1f1f1; border: 1px solid #ddd; border-radius: 4px;
            padding: 8px 16px; font-size: 14px; color: #555; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            margin: 15px auto 0; transition: all 0.3s ease;
        }
        .copy-btn:hover { background: #e9e9e9; }
        .copy-btn i { margin-right: 8px; }

        /* Indicador tipo campa√±a */
        .campaign-type-indicator {
            background-color: #f8fafa; border: 1px dashed #1890ff; border-radius: 4px;
            padding: 10px; margin: 15px 0; text-align: center; color: #1890ff;
            font-weight: 600; font-size: 14px; display: flex; align-items: center;
            justify-content: center; gap: 8px;
        }
        .campaign-type-indicator i { margin-right: 8px; }
        
        /* M√≥vil optimizado */
        @media (max-width: 600px) {
            .tab-group {
                flex-wrap: wrap;
                box-shadow: none;
            }
            .tab-button {
                border-radius: 4px !important;
                margin: 2px;
            }
            .creative-vertical .cta-button {
                padding: 16px 24px;
                margin-top: 20px;
                font-size: 16px;
            }
            .creative-vertical .service-icon {
                width: 60px;
                height: 60px;
                font-size: 28px;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="serviceTitle">Creativos de Alta Conversi√≥n para Optimizaci√≥n Express de Ads</h1>
            <p>Anuncios optimizados para maximizar conversiones en tus campa√±as de Ads</p>
        </div>

        <div class="campaign-type-indicator">
            <i class="fas fa-bullhorn"></i>
            <span>Creativos Optimizados para Maximizar Conversi√≥n</span>
        </div>

        <div class="tabs">
            <div class="tab-group">
                <button class="tab-button auditoria" data-service="auditoria">Auditor√≠a Gratis</button>
                <button class="tab-button optimizacion active" data-service="optimizacion">Optimizaci√≥n Express</button>
                <button class="tab-button meta" data-service="meta">Meta Ads</button>
                <button class="tab-button google" data-service="google">Google Ads</button>
                <button class="tab-button email" data-service="email">Email Marketing</button>
                <button class="tab-button chatbot" data-service="chatbot">Chatbot</button>
                <button class="tab-button all" data-service="all">Paquete Completo</button>
            </div>
        </div>

        <div class="platform-toggle">
            <button id="facebookBtn" class="platform-btn active" data-platform="facebook">
                <i class="fab fa-facebook"></i>
                <span>Facebook</span>
            </button>
            <button id="instagramBtn" class="platform-btn" data-platform="instagram">
                <i class="fab fa-instagram"></i>
                <span>Instagram</span>
            </button>
        </div>

        <div class="format-toggle">
            <button id="squareBtn" class="format-btn active">Cuadrado (1080x1080)</button>
            <button id="verticalBtn" class="format-btn">Vertical (1080x1920)</button>
        </div>

        <div class="color-toggle">
            <div class="color-btn color-btn-original active" data-color="original" title="Color original del servicio"></div>
            <div class="color-btn color-btn-orange" data-color="orange" title="Fondo naranja"></div>
            <div class="color-btn color-btn-white" data-color="white" title="Fondo blanco"></div>
            <div class="color-btn color-btn-black" data-color="black" title="Fondo negro"></div>
        </div>

        <div class="download-section">
            <button id="downloadBtn" class="download-btn">
                <i class="fas fa-download"></i>
                Descargar Creativo
            </button>
        </div>

        <div class="info-box">
            <i class="fas fa-info-circle"></i>
            <div>
                <p><strong>Instrucciones:</strong></p>
                <p>1. Seleccion√° el tipo de servicio de Ads que dese√°s generar.</p>
                <p>2. Eleg√≠ la plataforma (Facebook o Instagram) para optimizar el dise√±o.</p>
                <p>3. Seleccion√° el formato (cuadrado 1080x1080 o vertical 1080x1920).</p>
                <p>4. Eleg√≠ el color de fondo (original, naranja, blanco o negro).</p>
                <p>5. Hac√© clic en "Descargar Creativo" para obtener la imagen en alta resoluci√≥n.</p>
            </div>
        </div>

        <div class="text-20-indicator">
            <i class="fas fa-check-circle"></i>
            Texto optimizado (menos del 20% del espacio) - Aprobado para Meta Ads
        </div>

        <div class="best-practices" style="display: none;">
            <h3>Mejores Pr√°cticas para Anuncios de Alta Conversi√≥n:</h3>
            <ul>
                <li><strong>Elementos de prueba social</strong> - Incluir testimonios, resultados num√©ricos y garant√≠as</li>
                <li><strong>Contraste de colores</strong> - Destacar visualmente los elementos m√°s importantes</li>
                <li><strong>CTA claro y llamativo</strong> - El bot√≥n de llamada a la acci√≥n debe ser inmediatamente visible</li>
                <li><strong>Uso de urgencia</strong> - Elementos como "cupos limitados" o "48hs" crean impulso para actuar</li>
                <li><strong>Iconograf√≠a relevante</strong> - Usar iconos que refuercen el mensaje principal</li>
                <li><strong>Reducir la fricci√≥n</strong> - Incluir microcopy que elimine objeciones ("Sin compromiso", "Cancel√° cuando quieras")</li>
                <li><strong>Menos del 20% de texto</strong> - Meta penaliza anuncios con exceso de texto</li>
                <li><strong>Adaptar por plataforma</strong> - Facebook e Instagram tienen necesidades visuales diferentes</li>
            </ul>
        </div>
        <button class="toggle-practices" id="togglePractices">Ver mejores pr√°cticas para Ads</button>

        <div id="creativesContainer" class="creatives-container">
            <!-- El creativo se inserta din√°micamente aqu√≠ -->
        </div>

        <div class="note">
            <p>Dimensiones: 1080x1080 p√≠xeles y 1080x1920 p√≠xeles (im√°genes descargadas en alta resoluci√≥n)</p>
        </div>

        <div class="ad-copy-section">
            <h3>Copy Sugerido para Campa√±as de Ads (Alta Conversi√≥n)</h3>
            <div class="ad-copy-container">
                <p id="adCopyText" class="ad-copy-text"></p>
                <button id="copyBtn" class="copy-btn">
                    <i class="fas fa-copy"></i> Copiar
                </button>
            </div>
        </div>

        <canvas id="downloadCanvas"></canvas>
    </div>

    <script>
        const colors = {
            primary: '#ff7e00', dark: '#181818', light: '#ffffff',
            auditoria: '#28a745', optimizacion: '#dc3545', meta: '#1877F2',
            google: '#4285F4', googleRed: '#DB4437', googleYellow: '#F4B400',
            googleGreen: '#0F9D58', email: '#00829b', chatbot: '#6f42c1', 
            all: '#333333'
        };
        
        const gradients = {
            auditoria: 'linear-gradient(135deg, #28a745 0%, #1e7e34 100%)',
            optimizacion: 'linear-gradient(135deg, #dc3545 0%, #ad1f2d 100%)',
            meta: 'linear-gradient(135deg, #1877F2 0%, #0e4693 100%)',
            google: 'linear-gradient(135deg, #4285F4 0%, #2a61c5 100%)',
            email: 'linear-gradient(135deg, #00829b 0%, #00546a 100%)',
            chatbot: 'linear-gradient(135deg, #6f42c1 0%, #502e8c 100%)',
            all: 'linear-gradient(135deg, #333333 0%, #222222 100%)',
            orange: 'linear-gradient(135deg, #ff7e00 0%, #e67300 100%)'
        };

        const creativesData = {
            auditoria: { 
                title: 'AUDITOR√çA GRATIS DE ADS', 
                subtitle: 'DESCUBR√ç QU√â FALLA', 
                description: 'An√°lisis experto de tus campa√±as\nMeta Ads y Google Ads. Sin compromiso.', 
                bgColor: colors.auditoria,
                icon: 'fa-search-dollar',
                cta: 'Agendar Auditor√≠a',
                guaranteeText: 'An√°lisis en 24 horas',
                proofstat: '100%',
                prooftext: 'Gratis'
            },
            optimizacion: { 
                title: 'OPTIMIZACI√ìN EXPRESS DE ADS', 
                subtitle: 'MEJOR√Å TU ROAS EN 48HS', 
                description: 'Ajuste r√°pido de campa√±as de Ads\nReduc√≠ costes, aument√° conversiones.', 
                bgColor: colors.optimizacion,
                icon: 'fa-bolt',
                cta: 'Ver Detalles',
                guaranteeText: 'Sin riesgo: 50% si no funciona',
                proofstat: '48hs',
                prooftext: 'resultados r√°pidos',
                testimonio: '"Pasamos de 350% a 820% de ROAS"'
            },
            meta: { 
                title: 'META ADS: VENTAS ASEGURADAS', 
                subtitle: 'CAMPA√ëAS QUE S√ç CONVIERTEN', 
                description: 'Gesti√≥n experta de campa√±as\nMeta Ads (FB/IG). ROAS 2.8X garantizado.', 
                bgColor: colors.meta,
                icon: 'fa-facebook',
                cta: 'Potenciar Campa√±as',
                guaranteeText: 'ROAS m√≠nimo garantizado',
                proofstat: '2.8X',
                prooftext: 'ROAS garantizado',
                testimonio: '"Aumentamos ventas un 127%"'
            },
            google: { 
                title: 'GOOGLE ADS: M√ÅS CLIENTES', 
                subtitle: 'DOMIN√Å LAS B√öSQUEDAS YA', 
                description: 'Campa√±as rentables en Google Ads\nAtrae clientes listos para comprar.', 
                bgColor: colors.google,
                icon: 'fa-google',
                cta: 'Aparecer en Google',
                guaranteeText: 'Mayor visibilidad garantizada',
                proofstat: '32%',
                prooftext: 'menos CPA',
                testimonio: '"Tr√°fico cualificado de inmediato"'
            },
            email: { 
                title: 'CAMPA√ëAS DE EMAIL MARKETING', 
                subtitle: 'CONVERT√ç SUSCRIPTORES', 
                description: 'Optimizaci√≥n Express de campa√±as\nde Email Marketing. M√°s aperturas y ventas.', 
                bgColor: colors.email,
                icon: 'fa-envelope-open-text',
                cta: 'Revitalizar Emails',
                guaranteeText: '+38% tasa de apertura',
                proofstat: '12x',
                prooftext: 'm√°s ingresos',
                testimonio: '"De $400 a $4,800 mensuales"'
            },
            chatbot: { 
                title: 'CAMPA√ëAS CON CHATBOTS', 
                subtitle: 'AUTOMATIZ√Å Y VEND√â M√ÅS', 
                description: 'Optimizaci√≥n Express de Chatbots\npara tus campa√±as. Captur√° leads 24/7.', 
                bgColor: colors.chatbot,
                icon: 'fa-robot',
                cta: 'Implementar Chatbot',
                guaranteeText: 'Respuestas 24/7 garantizadas',
                proofstat: '68%',
                prooftext: 'tasa conversi√≥n',
                testimonio: '"Triplicamos leads cualificados"'
            },
            all: { 
                title: 'PAQUETE ADS COMPLETO', 
                subtitle: 'MAXIMIZ√Å TU ROI GLOBAL', 
                description: 'Meta Ads + Google Ads + Email + Chatbot\nOptimizaci√≥n integral por $1000/mes.', 
                bgColor: colors.all,
                icon: 'fa-rocket',
                cta: 'Obtener Pack Completo',
                guaranteeText: 'Resultados o pag√°s la mitad',
                proofstat: '$200',
                prooftext: 'ahorro mensual',
                testimonio: '"Soluci√≥n integral que funciona"'
            }
        };

        const ribbonData = {
            auditoria: 'GRATUITA', optimizacion: 'EN 48HS', meta: 'ROAS 2.8X GARANT.',
            google: 'ALTO ROI', email: '+38% APERTURA', chatbot: 'LEADS 24/7',
            all: 'AHORR√Å $200'
        };

        const adCopyData = {
            auditoria: `üîç ¬øTus campa√±as de Meta Ads y Google Ads no rinden como esperabas? üîç\n\nDescubr√≠ EXACTAMENTE d√≥nde est√°s perdiendo dinero y qu√© corregir.\n\n¬°Solicit√° tu Auditor√≠a de Ads GRATUITA! ‚è±Ô∏è\n\n‚úÖ An√°lisis detallado de estructura y configuraci√≥n.\n‚úÖ Identificaci√≥n de fugas de presupuesto.\n‚úÖ Recomendaciones claras para optimizar YA.\n‚úÖ 100% Gratis, sin compromiso.\n\nüëâ SOLO 3 CUPOS ESTA SEMANA - Visit√° nuestra web y ped√≠ tu auditor√≠a antes de que se acaben. ¬°Dej√° de tirar dinero!\n\n‚û°Ô∏è www.orangevapor.com`,
            optimizacion: `‚ö° ¬øCampa√±as de Ads activas pero SIN resultados? ¬°Optimizaci√≥n Express en 48hs! ‚ö°\n\nDeten√© el gasto innecesario y empez√° a ver conversiones REALES.\n\n‚úÖ Diagn√≥stico inmediato de puntos d√©biles\n‚úÖ Reestructuraci√≥n para m√°ximo rendimiento\n‚úÖ Ajuste de segmentaciones y creativos\n‚úÖ Resultados visibles en SOLO 48 HORAS\n\nüî• CASO REAL: Un cliente reciente pas√≥ de 350% a 820% de ROAS en menos de 72 horas.\n\n‚ö†Ô∏è OFERTA POR TIEMPO LIMITADO: Nuestro fee se reduce a la mitad si no mejoramos tus m√©tricas.\n\n¬øListo/a para transformar tus Ads? Visit√° üëá\nwww.orangevapor.com`,
            meta: `üì± ¬øInvert√≠s en Meta Ads (Facebook/Instagram) pero las ventas no llegan? üì±\n\n¬°Dej√° de adivinar y tir√° dinero! Nuestras campa√±as tienen un ROAS m√≠nimo GARANTIZADO de 2.8x.\n\n‚úÖ Estrategia personalizada para TU negocio\n‚úÖ Optimizaci√≥n continua basada en datos\n‚úÖ Reducci√≥n del costo por adquisici√≥n (CPA)\n‚úÖ Reportes claros enfocados en ROI\n\nüî• NUESTROS CLIENTES HABLAN: "Aumentamos ventas un 127% en 30 d√≠as con Orange Vapor"\n\n‚ö†Ô∏è GARANT√çA DE RESULTADOS: Si no alcanzamos los KPIs acordados, solo pag√°s la mitad del fee.\n\n¬°Es hora de que tus Ads trabajen para vos! Hac√© clic üëá\nwww.orangevapor.com`,
            google: `üîé ¬øTu competencia aparece en Google Ads y vos no? ¬°Perd√©s clientes TODOS LOS D√çAS! üîé\n\nConvert√≠ b√∫squedas activas en ventas con campa√±as de Google Ads OPTIMIZADAS.\n\n‚úÖ ROAS m√≠nimo 2.8x GARANTIZADO\n‚úÖ Palabras clave que S√ç convierten\n‚úÖ Reducci√≥n del CPA hasta un 32%\n‚úÖ Anuncios que destacan en la competencia\n\nüî• CUPOS LIMITADOS: Solo trabajamos con un negocio por nicho para garantizar resultados exclusivos.\n\n‚ö†Ô∏è Cada d√≠a que pasa sin aparecer en Google, tu competencia se lleva TUS CLIENTES.\n\n¬°Aparec√© donde te buscan tus clientes! üëá\nwww.orangevapor.com`,
            email: `üìß ¬øTen√©s una lista de emails pero no genera ventas? ¬°Optimiz√° tus Campa√±as de Email Marketing! üìß\n\nConvert√≠ suscriptores inactivos en clientes recurrentes.\n\n‚úÖ Secuencias automatizadas que nutren y venden\n‚úÖ Segmentaci√≥n avanzada para mensajes relevantes\n‚úÖ Aumento GARANTIZADO de tasa de apertura (+38%)\n‚úÖ Gener√° ingresos pasivos con tu base de datos\n\nüî• CASO DE √âXITO: Una cliente pas√≥ de generar $400 a $4,800 mensuales SOLO con email marketing.\n\n‚ö†Ô∏è Tu lista pierde valor cada d√≠a que no la monetiz√°s adecuadamente.\n\n¬°Monetiz√° tu lista AHORA! üëá\nwww.orangevapor.com`,
            chatbot: `ü§ñ ¬øPerd√©s leads y ventas por no responder al instante? ¬°Potenci√° tus Campa√±as con Chatbots! ü§ñ\n\nIntegr√° chatbots inteligentes para MAXIMIZAR la conversi√≥n de tus Ads.\n\n‚úÖ Captur√° y cualific√° leads 24/7/365\n‚úÖ Respond√© preguntas frecuentes al instante\n‚úÖ Tasa de conversi√≥n hasta 68% (vs 22% manual)\n‚úÖ Liber√° a tu equipo para tareas complejas\n\nüî• DATO IMPACTANTE: El 60% de los leads se pierden por no responder en los primeros 5 minutos.\n\n‚ö†Ô∏è OFERTA ESPECIAL: Implementaci√≥n gratuita si contrat√°s este mes.\n\n¬°No pierdas ni un lead m√°s! üëá\nwww.orangevapor.com`,
            all: `üöÄ ¬°La Estrategia de Ads COMPLETA que tu negocio necesita! üöÄ\n\n¬øPor qu√© elegir un solo canal cuando pod√©s dominar TODOS?\n\nNuestro Paquete Integral incluye:\n‚úÖ Meta Ads optimizados (Facebook e Instagram)\n‚úÖ Google Ads estrat√©gico con keywords premium\n‚úÖ Email Marketing automatizado con alta apertura\n‚úÖ Chatbots de conversi√≥n 24/7\n\nüí∞ AHORR√Å $200/MES: Normalmente $1,200/mes por separado\nAHORA: $1,000/mes - ¬°AHORRO REAL DE $2,400 AL A√ëO!\n\nüî• BONO EXCLUSIVO: Si contrat√°s ahora, incluimos la Optimizaci√≥n Express ($299) ¬°GRATIS!\n\n‚ö†Ô∏è GARANT√çA √öNICA: Si no mejoramos tus m√©tricas, solo pag√°s la mitad. Sin contratos largos.\n\nMaximiz√° tu presencia y ROI en todos los canales üëá\nwww.orangevapor.com`
        };

        let activeService = 'optimizacion';
        let activeFormat = 'square';
        let activeColor = 'original';
        let activePlatform = 'facebook';
        let isProcessing = false;

        const serviceTitle = document.getElementById('serviceTitle');
        const creativesContainer = document.getElementById('creativesContainer');
        const tabButtons = document.querySelectorAll('.tab-button');
        const formatButtons = document.querySelectorAll('.format-btn');
        const colorButtons = document.querySelectorAll('.color-btn');
        const platformButtons = document.querySelectorAll('.platform-btn');
        const squareBtn = document.getElementById('squareBtn');
        const verticalBtn = document.getElementById('verticalBtn');
        const facebookBtn = document.getElementById('facebookBtn');
        const instagramBtn = document.getElementById('instagramBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const togglePracticesBtn = document.getElementById('togglePractices');
        const bestPracticesBox = document.querySelector('.best-practices');
        const downloadCanvas = document.getElementById('downloadCanvas');
        const adCopyText = document.getElementById('adCopyText');
        const copyBtn = document.getElementById('copyBtn');

        copyBtn.addEventListener('click', () => {
            const textToCopy = adCopyText.textContent || adCopyText.innerText;
            navigator.clipboard.writeText(textToCopy)
                .then(() => {
                    copyBtn.innerHTML = '<i class="fas fa-check"></i> ¬°Copiado!';
                    setTimeout(() => { copyBtn.innerHTML = '<i class="fas fa-copy"></i> Copiar'; }, 2000);
                })
                .catch(err => {
                    console.error('Error al copiar: ', err);
                    copyBtn.innerHTML = '<i class="fas fa-times"></i> Error';
                    setTimeout(() => { copyBtn.innerHTML = '<i class="fas fa-copy"></i> Copiar'; }, 2000);
                });
        });

        togglePracticesBtn.addEventListener('click', () => {
            const isHidden = bestPracticesBox.style.display === 'none' || bestPracticesBox.style.display === '';
            bestPracticesBox.style.display = isHidden ? 'block' : 'none';
            togglePracticesBtn.textContent = isHidden ? 'Ocultar mejores pr√°cticas' : 'Ver mejores pr√°cticas para Ads';
        });

        function getServiceTitle(service) {
            const titleMap = {
                auditoria: 'Creativos para Auditor√≠a Gratis de Ads', 
                optimizacion: 'Creativos para Optimizaci√≥n Express de Ads',
                meta: 'Creativos para Campa√±as de Meta Ads', 
                google: 'Creativos para Campa√±as de Google Ads',
                email: 'Creativos para Campa√±as de Email Marketing', 
                chatbot: 'Creativos para Campa√±as con Chatbots',
                all: 'Creativos para Paquete de Ads Completo'
            };
            return titleMap[service] ? `Alta Conversi√≥n: ${titleMap[service]}` : 'Creativos de Alta Conversi√≥n para Ads';
        }

        function getBackgroundStyle() {
            if (activeColor === 'original') {
                return gradients[activeService] || gradients.orange;
            }
            if (activeColor === 'orange') return gradients.orange;
            if (activeColor === 'white') return colors.light;
            if (activeColor === 'black') return colors.dark;
            return gradients.orange;
        }

        function getTextColor(bgColor) {
            if (!bgColor) return colors.dark;
            // Si es un gradiente, tomar el primer color
            if (bgColor.includes('gradient')) {
                const startColor = bgColor.match(/#[0-9a-f]{6}/i)[0];
                bgColor = startColor;
            }
            
            let rgb;
            if (bgColor.startsWith('#')) {
                const bigint = parseInt(bgColor.slice(1), 16);
                rgb = { r: (bigint >> 16) & 255, g: (bigint >> 8) & 255, b: bigint & 255 };
            } else if (bgColor.startsWith('rgb')) {
                const matches = bgColor.match(/\d+/g);
                if (!matches || matches.length < 3) return colors.dark;
                rgb = { r: parseInt(matches[0]), g: parseInt(matches[1]), b: parseInt(matches[2]) };
            } else { return colors.dark; }
            const luminance = (0.299 * rgb.r + 0.587 * rgb.g + 0.114 * rgb.b) / 255;
            return luminance > 0.5 ? colors.dark : colors.light;
        }

        function getAccentColor(bgColor) {
            const textColor = getTextColor(bgColor);
            if (activeColor === 'orange') return textColor;
            if (activeColor === 'white' || activeColor === 'black') return colors.primary;
            return textColor;
        }
        
        function getCTAColor(service) {
            switch(service) {
                case 'auditoria': return '#28a745';
                case 'optimizacion': return '#dc3545';
                case 'meta': return '#1877F2';
                case 'google': return '#4285F4';
                case 'email': return '#00829b';
                case 'chatbot': return '#6f42c1';
                case 'all': return '#333333';
                default: return '#ff7e00';
            }
        }

        function renderCreative() {
            creativesContainer.innerHTML = '';
            const creative = creativesData[activeService];
            if (!creative) {
                console.error("Datos no encontrados para el servicio:", activeService);
                creativesContainer.innerHTML = '<p>Error: Datos del creativo no disponibles.</p>';
                return;
            }

            const bgStyle = getBackgroundStyle();
            const textColor = getTextColor(bgStyle);
            const accentColor = getAccentColor(bgStyle);
            const ctaColor = getCTAColor(activeService);

            const creativeEl = document.createElement('div');
            creativeEl.className = `creative ${activeFormat === 'vertical' ? 'creative-vertical' : ''}`;
            creativeEl.style.background = bgStyle;

            const ribbonText = ribbonData[activeService];
            if (ribbonText) {
                const ribbonEl = document.createElement('div');
                ribbonEl.className = 'creative-ribbon';
                ribbonEl.textContent = ribbonText;
                creativeEl.appendChild(ribbonEl);
            }

            // Agregamos prueba social si corresponde
            if (creative.proofstat && creative.prooftext) {
                const proofBadgeEl = document.createElement('div');
                proofBadgeEl.className = 'proof-badge';
                proofBadgeEl.innerHTML = `
                    <span class="proof-number">${creative.proofstat}</span>
                    <span class="proof-text">${creative.prooftext}</span>
                `;
                creativeEl.appendChild(proofBadgeEl);
            }

            const contentEl = document.createElement('div');
            contentEl.className = 'creative-content';

            // Logo
            const logoContainerEl = document.createElement('div');
            logoContainerEl.className = 'logo-container';
            const logoEl = document.createElement('div');
            logoEl.style.fontWeight = 'bold';
            logoEl.style.fontSize = '14px';
            if (activeColor === 'white') {
                logoEl.innerHTML = `<span style="color: ${colors.dark};">Orange</span> <span style="color: ${colors.primary};">Vapor</span>`;
            } else if (activeColor === 'orange') {
                logoEl.innerHTML = `<span style="color: ${colors.light};">Orange Vapor</span>`;
            } else {
                logoEl.innerHTML = `<span style="color: ${textColor};">Orange</span> <span style="color: ${colors.primary};">Vapor</span>`;
            }
            logoContainerEl.appendChild(logoEl);
            contentEl.appendChild(logoContainerEl);
            
            // Icono de servicio
            if (creative.icon) {
                const iconEl = document.createElement('div');
                iconEl.className = 'service-icon';
                iconEl.innerHTML = `<i class="fas ${creative.icon}"></i>`;
                contentEl.appendChild(iconEl);
            }

            // T√≠tulo
            const titleEl = document.createElement('div');
            titleEl.className = 'creative-title';
            titleEl.textContent = creative.title;
            titleEl.style.color = textColor;
            contentEl.appendChild(titleEl);

            // Subt√≠tulo
            const subtitleEl = document.createElement('div');
            subtitleEl.className = 'creative-subtitle';
            subtitleEl.textContent = creative.subtitle;
            subtitleEl.style.color = textColor;
            contentEl.appendChild(subtitleEl);

            // Descripci√≥n con palabras destacadas
            const descEl = document.createElement('div');
            descEl.className = 'creative-description';
            descEl.style.color = textColor;
            
            // Resaltar palabras clave
            let enhancedDescription = creative.description;
            
            // Destacar palabras clave espec√≠ficas seg√∫n el servicio
            const highlightTerms = {
                'optimizacion': ['48hs', 'Reduc√≠', 'aument√°'],
                'meta': ['ROAS 2.8X', 'Meta Ads', 'garantizado'],
                'google': ['rentables', 'clientes', 'comprar'],
                'email': ['Email Marketing', 'aperturas', 'ventas'],
                'chatbot': ['Chatbots', '24/7', 'leads'],
                'all': ['$1000/mes', 'integral']
            };
            
            if (highlightTerms[activeService]) {
                highlightTerms[activeService].forEach(term => {
                    enhancedDescription = enhancedDescription.replace(
                        new RegExp(term, 'g'), 
                        `<span class="highlight">${term}</span>`
                    );
                });
            }
            
            descEl.innerHTML = enhancedDescription;
            contentEl.appendChild(descEl);
            
            // CTA Button
            if (creative.cta) {
                const ctaEl = document.createElement('button');
                ctaEl.className = 'cta-button';
                ctaEl.innerHTML = `
                    <span class="cta-text">${creative.cta}</span>
                    <i class="fas fa-arrow-right arrow-icon"></i>
                `;
                ctaEl.style.color = activeColor === 'white' ? '#fff' : textColor;
                ctaEl.style.backgroundColor = ctaColor;
                contentEl.appendChild(ctaEl);
                
                // Texto de reducci√≥n de fricci√≥n para auditor√≠a y optimizaci√≥n
                if (activeService === 'auditoria' || activeService === 'optimizacion') {
                    const frictionReducerEl = document.createElement('div');
                    frictionReducerEl.className = 'friction-reducer';
                    frictionReducerEl.textContent = activeService === 'auditoria' ? 
                        'Sin compromiso ‚Ä¢ 100% gratis' : 
                        'Sin riesgo ‚Ä¢ Resultados o 50% off';
                    frictionReducerEl.style.color = textColor;
                    contentEl.appendChild(frictionReducerEl);
                }
            }
            
            // Garant√≠a si est√° disponible
            if (creative.guaranteeText) {
                const guaranteeEl = document.createElement('div');
                guaranteeEl.className = 'guarantee-badge';
                guaranteeEl.innerHTML = `
                    <i class="fas fa-shield-alt"></i>
                    <span>${creative.guaranteeText}</span>
                `;
                guaranteeEl.style.color = textColor;
                contentEl.appendChild(guaranteeEl);
            }
            
            // Urgencia para auditor√≠a
            if (activeService === 'auditoria') {
                const urgencyEl = document.createElement('div');
                urgencyEl.className = 'limited-spots';
                urgencyEl.innerHTML = `
                    <i class="fas fa-user-clock"></i>
                    <span>Solo 3 cupos disponibles esta semana</span>
                `;
                urgencyEl.style.color = textColor;
                contentEl.appendChild(urgencyEl);
            }
            
            // Mini testimonial si est√° disponible
            if (creative.testimonio) {
                const testimonialEl = document.createElement('div');
                testimonialEl.className = 'mini-testimonial';
                testimonialEl.innerHTML = `
                    <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                    <div class="quote">${creative.testimonio}</div>
                `;
                testimonialEl.style.color = textColor;
                contentEl.appendChild(testimonialEl);
            }

            creativeEl.appendChild(contentEl);

            // Bot√≥n de descarga
            const downloadEl = document.createElement('div');
            downloadEl.className = 'creative-download';
            downloadEl.innerHTML = `<i class="fas fa-download" style="color: ${colors.light};"></i>`;
            downloadEl.addEventListener('click', (e) => {
                e.stopPropagation();
                generateAndDownloadImage();
            });
            creativeEl.appendChild(downloadEl);

            creativeEl.addEventListener('click', generateAndDownloadImage);

            creativesContainer.appendChild(creativeEl);
            updateAdCopy();
        }

        function updateAdCopy() {
            adCopyText.textContent = adCopyData[activeService] || "Copy de anuncio no disponible para este servicio.";
            copyBtn.innerHTML = '<i class="fas fa-copy"></i> Copiar';
        }

        function showLoadingModal(message = "Generando imagen...") {
            if (document.getElementById('loadingModal')) return;
            const modalEl = document.createElement('div');
            modalEl.className = 'loading-modal';
            modalEl.id = 'loadingModal';
            modalEl.innerHTML = `
                <div class="loading-container">
                    <div class="loading-spinner"></div>
                    <div>${message}</div>
                </div>`;
            document.body.appendChild(modalEl);
        }
        
        function hideLoadingModal() {
            const modal = document.getElementById('loadingModal');
            if (modal) { document.body.removeChild(modal); }
        }

        async function generateAndDownloadImage() {
            if (isProcessing) return;
            isProcessing = true;
            showLoadingModal("Preparando fuentes y generando imagen...");

            try {
                console.log("Esperando fuentes...");
                await Promise.all([
                    document.fonts.load('bold 70px Montserrat'),
                    document.fonts.load('bold 80px Montserrat'),
                    document.fonts.load('bold 46px Montserrat'),
                    document.fonts.load('bold 56px Montserrat'),
                    document.fonts.load('normal 36px Montserrat'),
                    document.fonts.load('normal 42px Montserrat'),
                    document.fonts.load('bold 36px Montserrat'),
                    document.fonts.load('bold 42px Montserrat'),
                    document.fonts.load('bold 18px Montserrat'),
                    document.fonts.load('bold 22px Montserrat')
                ]);
                console.log("Fuentes cargadas.");

                const creative = creativesData[activeService];
                if (!creative) throw new Error(`Datos no encontrados para ${activeService}`);

                const isVertical = activeFormat === 'vertical';
                const width = 1080;
                const height = isVertical ? 1920 : 1080;

                downloadCanvas.width = width;
                downloadCanvas.height = height;
                const ctx = downloadCanvas.getContext('2d');
                ctx.clearRect(0, 0, width, height);

                // Crear gradiente para el fondo
                let bgStyle = getBackgroundStyle();
                if (bgStyle.includes('gradient')) {
                    // Extraer colores del gradiente
                    const startColor = bgStyle.match(/#[0-9a-f]{6}/ig)[0];
                    const endColor = bgStyle.match(/#[0-9a-f]{6}/ig)[1];
                    
                    const gradient = ctx.createLinearGradient(0, 0, width, height);
                    gradient.addColorStop(0, startColor);
                    gradient.addColorStop(1, endColor);
                    ctx.fillStyle = gradient;
                } else {
                    ctx.fillStyle = bgStyle;
                }
                ctx.fillRect(0, 0, width, height);

                const textColor = getTextColor(bgStyle);
                const ctaColor = getCTAColor(activeService);

                // Dibujar logo
                const logoFontSize = isVertical ? 42 : 36;
                ctx.font = `bold ${logoFontSize}px Montserrat, sans-serif`;
                ctx.textAlign = 'left';
                const logoX = 40;
                const logoY = 60;
                if (activeColor === 'white') {
                    ctx.fillStyle = colors.dark;
                    ctx.fillText('Orange', logoX, logoY);
                    const orangeWidth = ctx.measureText('Orange ').width;
                    ctx.fillStyle = colors.primary;
                    ctx.fillText('Vapor', logoX + orangeWidth, logoY);
                } else if (activeColor === 'orange') {
                    ctx.fillStyle = colors.light;
                    ctx.fillText('Orange Vapor', logoX, logoY);
                } else {
                    ctx.fillStyle = textColor;
                    ctx.fillText('Orange', logoX, logoY);
                    const orangeWidth = ctx.measureText('Orange ').width;
                    ctx.fillStyle = colors.primary;
                    ctx.fillText('Vapor', logoX + orangeWidth, logoY);
                }

                // Dibujar icono de servicio
                if (creative.icon) {
                    // Aqu√≠ usar√≠amos canvas-icons o tendr√≠amos que dibujar formas b√°sicas para el icono
                    // Como alternativa, dibujamos un c√≠rculo con el color del servicio
                    const iconSize = isVertical ? 60 : 50;
                    const iconX = width / 2;
                    const iconY = logoY + 80;
                    
                    // C√≠rculo de fondo
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';
                    ctx.beginPath();
                    ctx.arc(iconX, iconY, iconSize / 2, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Simplificar con texto de icono (en producci√≥n deber√≠as usar una librer√≠a como FontAwesome para canvas)
                    ctx.fillStyle = textColor;
                    ctx.font = `bold ${isVertical ? 24 : 20}px Montserrat, sans-serif`;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    
                    // Mapeamos los iconos a simbolos simples para el canvas
                    const iconText = {
                        'fa-search-dollar': '$',
                        'fa-bolt': '‚ö°',
                        'fa-facebook': 'f',
                        'fa-google': 'G',
                        'fa-envelope-open-text': '‚úâ',
                        'fa-robot': 'ü§ñ',
                        'fa-rocket': 'üöÄ'
                    };
                    
                    ctx.fillText(iconText[creative.icon] || '‚Ä¢', iconX, iconY);
                }

                // Configurar para el contenido central
                ctx.textAlign = 'center';
                const contentStartY = logoY + 140;
                const availableHeightForText = height - contentStartY - 40;
                const contentCenterY = contentStartY + availableHeightForText / 2;
                const textMaxWidth = width - 100;

                // T√≠tulo
                const titleFontSize = isVertical ? 80 : 70;
                ctx.font = `bold ${titleFontSize}px Montserrat, sans-serif`;
                ctx.fillStyle = textColor;
                const titleLineHeight = titleFontSize * 1.1;
                
                // Calculamos l√≠neas para centrar verticalmente
                const titleLines = calculateWrappedLines(ctx, creative.title, textMaxWidth);
                const subtitleFontSize = isVertical ? 56 : 46;
                const descFontSize = isVertical ? 42 : 36;
                const descLineHeight = descFontSize * 1.2;
                const descLines = calculateWrappedLines(ctx, creative.description, textMaxWidth);
                
                // Altura total estimada del bloque de texto + elementos
                const totalTextHeight = 
                    (titleLines * titleLineHeight) + 
                    subtitleFontSize + 
                    (isVertical ? 80 : 70) + 
                    (descLines * descLineHeight) +
                    (isVertical ? 120 : 100); // Espacio para CTA y otros elementos
                
                const titleStartY = contentCenterY - (totalTextHeight / 2);

                // Dibujar t√≠tulo
                wrapText(ctx, creative.title, width / 2, titleStartY, textMaxWidth, titleLineHeight);

                // Dibujar subt√≠tulo
                const subtitleY = titleStartY + (titleLines * titleLineHeight) + (isVertical ? 20 : 30);
                ctx.font = `bold ${subtitleFontSize}px Montserrat, sans-serif`;
                ctx.fillStyle = textColor;
                ctx.fillText(creative.subtitle, width / 2, subtitleY);

                // Dibujar descripci√≥n 
                const descY = subtitleY + subtitleFontSize + (isVertical ? 60 : 50);
                ctx.font = `${descFontSize}px Montserrat, sans-serif`;
                ctx.fillStyle = textColor;
                
                // Procesamiento especial para destacar palabras clave
                // Como no podemos usar HTML en canvas, simplificamos y usamos texto normal
                wrapText(ctx, creative.description, width / 2, descY, textMaxWidth, descLineHeight);
                
                // Calcular posici√≥n Y final despu√©s de la descripci√≥n
                let currentY = descY + (descLines * descLineHeight) + 30;
                
                // Dibujar CTA
                if (creative.cta) {
                    const ctaFontSize = isVertical ? 36 : 30;
                    const ctaY = currentY + 20;
                    const ctaWidth = 240;
                    const ctaHeight = 50;
                    const ctaX = width / 2 - ctaWidth / 2;
                    
                    // Fondo del CTA
                    ctx.fillStyle = ctaColor;
                    ctx.beginPath();
                    ctx.roundRect(ctaX, ctaY, ctaWidth, ctaHeight, 25);
                    ctx.fill();
                    
                    // Texto del CTA
                    ctx.fillStyle = '#FFFFFF';
                    ctx.font = `bold ${ctaFontSize}px Montserrat, sans-serif`;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(creative.cta, width / 2, ctaY + ctaHeight / 2);
                    
                    currentY = ctaY + ctaHeight + 15;
                    
                    // Texto de reducci√≥n de fricci√≥n
                    if (activeService === 'auditoria' || activeService === 'optimizacion') {
                        const frictionText = activeService === 'auditoria' ? 
                            'Sin compromiso ‚Ä¢ 100% gratis' : 
                            'Sin riesgo ‚Ä¢ Resultados o 50% off';
                        
                        ctx.font = `${isVertical ? 28 : 24}px Montserrat, sans-serif`;
                        ctx.fillStyle = textColor;
                        ctx.fillText(frictionText, width / 2, currentY + 20);
                        
                        currentY += 40;
                    }
                }
                
                // Dibujar sello de garant√≠a si existe
                if (creative.guaranteeText) {
                    currentY += 15;
                    const guaranteeText = creative.guaranteeText;
                    
                    // Fondo semi-transparente
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.15)';
                    const guaranteeWidth = ctx.measureText(guaranteeText).width + 60;
                    const guaranteeHeight = 36;
                    const guaranteeX = width / 2 - guaranteeWidth / 2;
                    
                    ctx.beginPath();
                    ctx.roundRect(guaranteeX, currentY, guaranteeWidth, guaranteeHeight, 18);
                    ctx.fill();
                    
                    // Icono y texto
                    ctx.fillStyle = textColor;
                    ctx.font = `${isVertical ? 28 : 24}px Montserrat, sans-serif`;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    // Aqu√≠ simplificamos el icono con un texto
                    ctx.fillText(`üõ°Ô∏è ${guaranteeText}`, width / 2, currentY + guaranteeHeight / 2);
                    
                    currentY += guaranteeHeight + 20;
                }
                
                // Dibujar indicador de urgencia para auditor√≠a
                if (activeService === 'auditoria') {
                    const urgencyText = 'Solo 3 cupos disponibles esta semana';
                    
                    // Fondo rojo semi-transparente
                    ctx.fillStyle = 'rgba(255, 0, 0, 0.1)';
                    const urgencyWidth = width * 0.7;
                    const urgencyHeight = 40;
                    const urgencyX = width / 2 - urgencyWidth / 2;
                    
                    ctx.beginPath();
                    ctx.roundRect(urgencyX, currentY, urgencyWidth, urgencyHeight, 5);
                    ctx.fill();
                    
                    // Borde lateral
                    ctx.fillStyle = 'rgba(255, 0, 0, 0.5)';
                    ctx.fillRect(urgencyX, currentY, 4, urgencyHeight);
                    
                    // Texto
                    ctx.fillStyle = textColor;
                    ctx.font = `${isVertical ? 26 : 22}px Montserrat, sans-serif`;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(`‚è±Ô∏è ${urgencyText}`, width / 2, currentY + urgencyHeight / 2);
                    
                    currentY += urgencyHeight + 20;
                }
                
                // Dibujar mini testimonial si existe
                if (creative.testimonio) {
                    // Fondo semi-transparente
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';
                    const testimonialWidth = width * 0.6;
                    const testimonialHeight = 70;
                    const testimonialX = width / 2 - testimonialWidth / 2;
                    
                    ctx.beginPath();
                    ctx.roundRect(testimonialX, currentY, testimonialWidth, testimonialHeight, 8);
                    ctx.fill();
                    
                    // Estrellas
                    ctx.fillStyle = '#FFD700'; // Color dorado
                    ctx.font = `${isVertical ? 28 : 24}px Montserrat, sans-serif`;
                    ctx.textAlign = 'center';
                    ctx.fillText('‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ', width / 2, currentY + 25);
                    
                    // Texto testimonial
                    ctx.fillStyle = textColor;
                    ctx.font = `italic ${isVertical ? 26 : 22}px Montserrat, sans-serif`;
                    ctx.fillText(creative.testimonio, width / 2, currentY + 55);
                }

                // Dibujar ribbon
                const ribbonText = ribbonData[activeService];
                if (ribbonText) {
                    ctx.save();
                    ctx.translate(width, 0);
                    ctx.rotate(45 * Math.PI / 180);

                    const ribbonBgColor = '#FFD700';
                    const ribbonTextColor = '#333';
                    const ribbonHeight = isVertical ? 55 : 45;
                    const ribbonWidth = isVertical ? 300 : 250;
                    const ribbonFontSize = isVertical ? 22 : 18;

                    const diagonalShift = 30;
                    const verticalCenter = 0;

                    // Crear gradiente para el ribbon
                    const ribbonGradient = ctx.createLinearGradient(
                        diagonalShift, verticalCenter,
                        diagonalShift + ribbonWidth, verticalCenter
                    );
                    ribbonGradient.addColorStop(0, '#FFD700');
                    ribbonGradient.addColorStop(1, '#FFC107');
                    
                    ctx.fillStyle = ribbonGradient;
                    ctx.fillRect(
                        diagonalShift,
                        verticalCenter - ribbonHeight / 2,
                        ribbonWidth,
                        ribbonHeight
                    );

                    // Sombra suave
                    ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
                    ctx.shadowBlur = 5;
                    ctx.shadowOffsetX = 2;
                    ctx.shadowOffsetY = 2;

                    ctx.fillStyle = ribbonTextColor;
                    ctx.font = `bold ${ribbonFontSize}px Montserrat, sans-serif`;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';

                    ctx.fillText(
                        ribbonText,
                        diagonalShift + ribbonWidth / 2,
                        verticalCenter
                    );

                    // Restablecer sombra
                    ctx.shadowColor = 'transparent';
                    ctx.shadowBlur = 0;
                    ctx.shadowOffsetX = 0;
                    ctx.shadowOffsetY = 0;

                    ctx.restore();
                }
                
                // Badge de prueba social si existe
                if (creative.proofstat && creative.prooftext) {
                    const badgeX = width - 70;
                    const badgeY = 80;
                    const badgeRadius = 40;
                    
                    // Fondo del badge
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                    ctx.beginPath();
                    ctx.arc(badgeX, badgeY, badgeRadius, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Texto del stat
                    ctx.fillStyle = colors.primary;
                    ctx.font = `bold ${isVertical ? 24 : 20}px Montserrat, sans-serif`;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(creative.proofstat, badgeX, badgeY - 8);
                    
                    // Texto descriptivo
                    ctx.fillStyle = '#333';
                    ctx.font = `${isVertical ? 14 : 12}px Montserrat, sans-serif`;
                    ctx.fillText(creative.prooftext, badgeX, badgeY + 14);
                }

                // Descargar la imagen
                const dataUrl = downloadCanvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.href = dataUrl;
                link.download = `orange-vapor-${activeService}-${activeColor}-${activeFormat}-${activePlatform}.png`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

            } catch (error) {
                console.error('Error al generar/descargar la imagen:', error);
                alert(`Hubo un error al generar la imagen: ${error.message}. Por favor, intent√° de nuevo.`);
            } finally {
                hideLoadingModal();
                isProcessing = false;
            }
        }

        function wrapText(ctx, text, x, y, maxWidth, lineHeight) {
            const words = text.split(/[\s\n]+/);
            let line = '';
            let currentY = y;
            for (let n = 0; n < words.length; n++) {
                if (words[n].includes('\n')) {
                     const parts = words[n].split('\n');
                     let testLineBeforeBreak = line + parts[0] + ' ';
                     if (ctx.measureText(testLineBeforeBreak).width <= maxWidth || line === '') {
                         line = testLineBeforeBreak;
                     } else {
                         ctx.fillText(line.trim(), x, currentY);
                         line = parts[0] + ' ';
                     }
                     ctx.fillText(line.trim(), x, currentY);
                     currentY += lineHeight;
                     line = parts[1] ? parts[1] + ' ' : '';
                     if (!parts[1] && n === words.length -1) return;
                     if (!parts[1]) continue;
                }

                const testLine = line + words[n] + ' ';
                const metrics = ctx.measureText(testLine);
                const testWidth = metrics.width;
                if (testWidth > maxWidth && n > 0 && line !== '') {
                    ctx.fillText(line.trim(), x, currentY);
                    line = words[n] + ' ';
                    currentY += lineHeight;
                } else {
                    line = testLine;
                }
            }
             if (line.trim() !== '') {
                 ctx.fillText(line.trim(), x, currentY);
             }
        }

        function calculateWrappedLines(ctx, text, maxWidth) {
            const words = text.split(/[\s\n]+/);
            let line = '';
            let lines = 0;
            let firstWord = true;

            for (let n = 0; n < words.length; n++) {
               if (firstWord) {
                   lines++;
                   firstWord = false;
               }
                const testLine = line + words[n] + ' ';
                const metrics = ctx.measureText(testLine);
                const testWidth = metrics.width;
                if (testWidth > maxWidth && n > 0 && line !== '') {
                    lines++;
                    line = words[n] + ' ';
                } else {
                    line = testLine;
                }
            }
            
            lines += (text.match(/\n/g) || []).length;
            return lines || 1;
        }

        function updateUI() {
            serviceTitle.textContent = getServiceTitle(activeService);
            
            // Actualizar botones de servicio
            tabButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.service === activeService) { 
                    btn.classList.add('active'); 
                }
            });
            
            // Actualizar botones de formato
            formatButtons.forEach(btn => btn.classList.remove('active'));
            if (activeFormat === 'square') { 
                squareBtn.classList.add('active'); 
            } else { 
                verticalBtn.classList.add('active'); 
            }
            
            // Actualizar botones de color
            colorButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.color === activeColor) { 
                    btn.classList.add('active'); 
                }
            });
            
            // Actualizar botones de plataforma
            platformButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.platform === activePlatform) {
                    btn.classList.add('active');
                }
            });
            
            renderCreative();
        }

        // Event listeners para todos los botones
        tabButtons.forEach(btn => btn.addEventListener('click', () => { 
            activeService = btn.dataset.service; 
            updateUI(); 
        }));
        
        squareBtn.addEventListener('click', () => { 
            activeFormat = 'square'; 
            updateUI(); 
        });
        
        verticalBtn.addEventListener('click', () => { 
            activeFormat = 'vertical'; 
            updateUI(); 
        });
        
        facebookBtn.addEventListener('click', () => {
            activePlatform = 'facebook';
            updateUI();
        });
        
        instagramBtn.addEventListener('click', () => {
            activePlatform = 'instagram';
            updateUI();
        });
        
        colorButtons.forEach(btn => btn.addEventListener('click', () => { 
            activeColor = btn.dataset.color; 
            updateUI(); 
        }));
        
        downloadBtn.addEventListener('click', generateAndDownloadImage);

        // Inicializar la interfaz
        updateUI();
    </script>
</body>
</html>
